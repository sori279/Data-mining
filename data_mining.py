
'''
ูุนุฑู ฺฉุชุงุจ:   
    1- ูุญูุฏ ุตูุน ุขุจุงุฏู ุ ุณูุง ูุญููุฏูุ ูุญุฏุซู ุทุงูุฑูพุฑูุฑุ
    ุฏุงุฏู ฺฉุงูู ฺฉุงุฑุจุฑุฏูุ ูุงุดุฑ ูุงุฒ ุฏุงูุดุ ฺุงูพ ุณููุ 1396.
    2- Larose D.T. and Larose C.D. (2014) Discovering knowledge in data: an introduction to data mining
(Second edition). John Wiley & Sons.
    
  3-  Aggarwal, Data Mining: The Textbook (2015)
'''
'''
ุณุฑูุตู ูุง:
8 ุชุง 12 ููุฑุฏ ุงุฒ ููุงุฑุฏ ุฒุฑ: 
1โ ููุฏูู ุง ุจุฑ ุฏุงุฏู ฺฉุงูุ ูพุด ูพุฑุฏุงุฒุด ุฏุงุฏู ูุงุ ุชุญูู ุงฺฉุชุดุงู ู ุชูุตู ุฏุงุฏู ูุง
2โ ุชุญูู ุขูุงุฑ ุชฺฉ ูุชุบุฑูุ ฺูุฏูุชุบุฑู ู ูุฏู ุฑฺฏุฑุณูู ุฎุท 
3โ ุขูุงุฏู ุณุงุฒ ุฏุงุฏู ูุง ุจุฑุง ูุฑูุฏ ุจู ูุฏู
4-K-NN ุงูฺฏูุฑุชู 
5โ ุงูฺฏูุฑุชู ุจุฒ ุณุงุฏู 
6โ ุงูฺฏูุฑุชู ูุงุดู ุจุฑุฏุงุฑ ูพุดุชุจุงู 
7โ ุงูฺฏูุฑุชู ุฏุฑุฎุช ุชุตูู
8โ ุงูฺฏูุฑุชู ุดุจฺฉู ูุง ุนุตุจ 
9โ ุงูฺฏูุฑุชู ูุง ุฎูุดู ุจูุฏ 
10โ ููุงูู ุงูุฌูู 
11โ ุงุฑุฒุงุจ ูุฏู ูุง
12โ ุฎูุดู ุจูุฏ ุฌุฑุงู ุฏุงุฏู ูุง 
13โ ฺฏุฑุงู ฺฉุงู


'''

'''
ููุชู 1 โ 
ููุถูุน ูุง ุชุฆูุฑ:
ููุฏูู ุจุฑ ุฏุงุฏูโฺฉุงู ู ุชุญูู ุฏุงุฏูโูุง

   ุจุฎุด 1 โ ููุฏูู ุจุฑ ุฏุงุฏูโฺฉุงู ู ุชุญูู ุฏุงุฏูโูุง

   1. ุฏุงุฏูโฺฉุงู ฺุณุชุ

ุชุนุฑู: ุฏุงุฏูโฺฉุงู (Data Mining) ุนู ูพุฏุง ฺฉุฑุฏู ุงูฺฏููุง ูพููุงู ู ููุฏ ุฏุฑ ูุฌููุนูโูุง ุจุฒุฑฺฏ ุฏุงุฏู.
  ูุซุงู ุฑูุฒูุฑู: ููุช ุดูุง ุฏุฑ ุฏุฌโฺฉุงูุง ุง ุขูุงุฒูู ุฎุฑุฏ ูโฺฉูุฏ ู ุณุณุชู ุจู ุดูุง 
 ูพุดููุงุฏ ูโุฏูุฏ "ุงูุฑุงุฏ ูุดุงุจู ุดูุง ุงู ฺฉุงูุง ุฑุง ูู ุฎุฑุฏูโุงูุฏ"ุ ุงู ูุชุฌูโ ุฏุงุฏูโฺฉุงู ุงุณุช.
* ูุฏู ุฏุงุฏูโฺฉุงู: ุชุจุฏู ุฏุงุฏู ุฎุงู ุจู ุฏุงูุด ูุงุจู ุงุณุชูุงุฏู.

---

  2. ุชูุงูุช ุฏุงุฏูโฺฉุงู ุจุง ุขูุงุฑ ู ุงุฏฺฏุฑ ูุงุดู

 ุขูุงุฑ ุจุดุชุฑ ุฑู ุชูุตู ุฏุงุฏู ู ุขุฒููู ูุฑุถูโูุง
 ุชูุฑฺฉุฒ ุฏุงุฑุฏ (ูุซูุงู: ูุงูฺฏู ูุฏ ุฏุงูุดุฌูุงู ฺูุฏ ุงุณุชุ).
 ุงุฏฺฏุฑ ูุงุดู (Machine Learning)  ุฑู ุณุงุฎุช 
ูุฏูโูุง ุจุฑุง ูพุดโุจู ู ุชุตููโฺฏุฑ ุชูุฑฺฉุฒ ุฏุงุฑุฏ
 (ูุซูุงู: ุขุง ุงู ุงูู Spam ุงุณุช ุง ููุ).
 ุฏุงุฏูโฺฉุงู  ุชุฑฺฉุจ ุงุฒ ุงู ุฏู ุงุณุช:

    ุงุฒ ุขูุงุฑ ุจุฑุง ุชุญูู ุฏุงุฏู
    ุงุฒ ุงุฏฺฏุฑ ูุงุดู ุจุฑุง ุณุงุฎุช ูุฏู
    ู ุฏุฑ ููุงุช ุชูุฑฺฉุฒ ุขู ุฑู ฺฉุดู ุงูฺฏููุง ูพููุงู ุฏุฑ ุฏุงุฏูโูุง ูุงูุน  ุงุณุช.

---

  3. ูุฑุขูุฏ ฺฉุดู ุฏุงูุด ุฏุฑ ูพุงฺฏุงู ุฏุงุฏูโูุง (KDD Process)

ุฏุงุฏูโฺฉุงู ููุท ุงุฌุฑุง ุงูฺฏูุฑุชู ูุณุชุ ุจูฺฉู ฺฉ ฺุฑุฎู ฺฉุงูู  ุฏุงุฑุฏ:

1. ุงูุชุฎุงุจ ุฏุงุฏู (Data Selection): ุงูุชุฎุงุจ ุจุฎุด ุงุฒ ุฏุงุฏู ฺฉู ูุฑุชุจุท ุงุณุช.

   ูุซุงู: ุงุฒ ฺฉู ุฏุชุงุจุณ ุจุงูฺฉ ููุท ุชุฑุงฺฉูุดโูุง ถ ูุงู ุงุฎุฑ ุฑุง ุงูุชุฎุงุจ ูโฺฉูู.

2.ูพุดโูพุฑุฏุงุฒุด (Preprocessing): ูพุงฺฉุณุงุฒ ุฏุงุฏูโูุง ูุงูุตุ ูพุฑุช ุง ฺฏูุดุฏู.

  ูุซุงู: ุญุฐู ุณุทุฑูุง ฺฉู ุชุงุฑุฎ ุง ููุฏุงุฑ ุชุฑุงฺฉูุด ุซุจุช ูุดุฏู ุงุณุช.

3.ุชุจุฏู ุฏุงุฏู (Transformation): ุชุบุฑ ุดฺฉู ุฏุงุฏู ุจุฑุง ุชุญูู ุจูุชุฑ.

   ูุซุงู: ูุฑูุงูโุณุงุฒ ุฏุฑุขูุฏ ุงูุฑุงุฏ ุจู ุจุงุฒู ฐ ุชุง ฑ.

4. ุฏุงุฏูโฺฉุงู (Data Mining): ุงุฌุฑุง ุงูฺฏูุฑุชูโูุง ูุซู ุฎูุดูโุจูุฏุ ุฑุฏูโุจูุฏุ ูพุดโุจู.

   ูุซุงู: ุงุณุชูุงุฏู ุงุฒ ุงูฺฏูุฑุชู K-means ุจุฑุง ฺฏุฑููโุจูุฏ ูุดุชุฑุงู ุจุงูฺฉ.

5.ุชูุณุฑ ู ุงุฑุฒุงุจ (Interpretation & Evaluation): ุจุฑุฑุณ ุงูฺฏููุง ู ุชุตููโฺฏุฑ.

   ูุซุงู: ุดูุงุณุง ฺฏุฑูู ูุดุชุฑุงู ุจุง ุจุดุชุฑู ุงุญุชูุงู ุฏุฑุงูุช ูุงู.

  ูููุฏุงุฑ ฺุฑุฎู KDD ุฏุฑ ฺฉุชุงุจ ูุง ูู ุขูุฏู ุงุณุช ู ูุนูููุงู ุจู ุดฺฉู ฺฉ ุฏุงุฑู ููุงุด ุฏุงุฏู ูโุดูุฏ.

---

  4. ฺฉุงุฑุจุฑุฏูุง ุฏุงุฏูโฺฉุงู

 ฺฉุงุฑุจุฑุฏูุง ูุงูุน:

 ุจุงุฒุงุฑุงุจ: ุชุญูู ุณุจุฏ ุฎุฑุฏ ูุดุชุฑุงู (Market Basket Analysis) ุจุนุฏุด ูพุดููุงุฏ ฺฉุงูุง.
 ูพุฒุดฺฉ:  ุชุดุฎุต ุจูุงุฑ ุงุฒ ุฑู ุชุตูุฑ ุง ุขุฒูุงุด ุฎูู.
 ูุงู:  ฺฉุดู ุชุฑุงฺฉูุดโูุง ุชููุจ ุง ูพุดโุจู ุฑุณฺฉ ูุงู.
 ุดุจฺฉูโูุง ุงุฌุชูุงุน:  ูพุดููุงุฏ ุฏูุณุช ุฏุฑ ูุณุจูฺฉ ุง ูุฏู ุฏุฑ ูุชูุจ.
 ุงูุชุฑูุช ู ูุจ:  ููุชูุฑ ุฌุณุชุฌู (Google) ุจุง ุงุณุชูุงุฏู
 ุงุฒ ุงูฺฏูุฑุชูโูุง ุฏุงุฏูโฺฉุงู ูุชุงุฌ ูุฑุชุจุทโุชุฑ ุงุฑุงุฆู ูโุฏูุฏ.

---

  5. ูุซุงู ุณุงุฏู :
  ูุฑุถ ฺฉูุฏ ุฏุงุฏูโุง ุงุฒ ุฏุงูุดุฌูุงู ฺฉ ุฏุงูุดฺฏุงู  ุฏุงุฑู ุดุงูู:

* ุณู
* ูุนุฏู
* ุชุนุฏุงุฏ ูุงุญุฏูุง ูพุงุณโุดุฏู
* ูุถุนุช ูุงุฑุบโุงูุชุญุตู

ุจุง ุฏุงุฏูโฺฉุงู ูโุชูุงูู:

* ูพุดโุจู ฺฉูู ฺฉุฏุงู ุฏุงูุดุฌูุงู ุงุญุชูุงู ุฏุงุฑุฏ ูุงุฑุบโุงูุชุญุตู ุดููุฏ (Classification).
* ฺฏุฑููโูุง ูุฎุชูู ุฏุงูุดุฌูุงู ุฑุง ูพุฏุง ฺฉูู (Clustering).
* ุนูุงูู ููููุช ุฑุง ฺฉุดู ฺฉูู (Association Rules).

---


---
ุจุฎุด 2: ุงููู ูุซุงู ุฏุงุฏูโฺฉุงู
'''
'''
   ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏู ููููู (Iris Dataset)

ุงู ุฏุงุฏู ุดุงูู ฑตฐ ฺฏู ุงุฒ ณ ฺฏููู ูุฎุชูู ุงุณุช.
'''

from sklearn.datasets import load_iris
import pandas as pd

# ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏู
iris = load_iris()

# ุชุจุฏู ุจู DataFrame
df = pd.DataFrame(iris.data, columns=iris.feature_names)
df['species'] = iris.target

# ููุงุด ต ุณุทุฑ ุงูู
print('ููุงุด ต ุณุทุฑ ุงูู')
print(df.head())
'''
 ุจุฑุฑุณ ุขูุงุฑ ุฏุงุฏูโูุง
 ุฎูุงุตู ุขูุงุฑ
 '''
print('ุฎูุงุตู ุขูุงุฑ')
print(df.describe())
'''
ุชูุณุฑ:

count = ููู ุณุชููโูุง ฑตฐ ุฏุงุฏู ุฏุงุฑูุฏ (ูฺ ููุฏุงุฑ ฺฏูุดุฏู ูุณุช).

mean = ูุงูฺฏู ุทูู ฺฉุงุณุจุฑฺฏ ุญุฏูุฏ ต.ธด ุณุงูุชโูุชุฑู.

std = ุงูุญุฑุงู ูุนุงุฑ ุทูู ฺฉุงุณุจุฑฺฏ ุญุฏูุฏ ฐ.ธฒ ูุณุช
 ูุฐุง ุฏุงุฏูโูุง ูุณุจุชุง ูพุฑุงฺฉูุฏฺฏ ฺฉู ุฏุงุฑูุฏ.

25%, 50%, 75% = ุญุฏูุฏ ูุฑูุงู ุฏุงุฏูโูุง ุฑู ูุดูู ูุฏู. 
ูุซูุง ตฐูช ฺฏูโูุง ุทูู ฺฉุงุณุจุฑฺฏ ฺฉูฺฺฉุชุฑ ุง ูุณุงู ต.ธ ุฏุงุฑู.

min ู max = ุจุงุฒูโ ุชุบุฑุงุช ูุฑ ูฺฺฏ.

  ุงู ุฌุฏูู ุงููู ูุฏู ุจุฑุง ุดูุงุฎุช ุฏุงุฏูโุณุช 
  ูุฐุง ฺฉูฺฉ ูโฺฉูู ุจุจูู ุฏุงุฏูโูุง ูุงูุตู ุง ููุ 
  ุจุงุฒู ููุงุฏุฑ ฺูุฏูุ ู ูพุฑุงฺฉูุฏฺฏ ฺูุฏุฑู.
'''
print('ุดูุงุฑุด ูุฑ ฺฉูุงุณ')
# ุดูุงุฑุด ูุฑ ฺฉูุงุณ
print(df['species'].value_counts())

'''
 ุฏุฏุงุฑโุณุงุฒ ุงููู
'''
import matplotlib.pyplot as plt
import seaborn as sns

# ูููุฏุงุฑ ุฌูุช ุจุฑุง ุจุฑุฑุณ ูฺฺฏโูุง
sns.pairplot(df, hue="species")

'''
pairplot   
ููู ุชุฑฺฉุจโูุง ุฏู ุจู ุฏู ุงู ูฺฺฏโูุง ุฑู ุฑุณู ูโฺฉูู
ู hue  ุจุฑุง ุงูุชุฎุงุจ ุชุนุฏุงุฏ ุฑูฺฏูุงุณุช
'''
plt.show()

'''
ุงููู ูุฏู ุฏุงุฏูโฺฉุงู (ุฑุฏูโุจูุฏ )
'''
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import accuracy_score

# ุฏุงุฏูโูุง
X = df.drop('species', axis=1)
y = df['species']
'''
axis=1 ุนู ุญุฐู ุจุฑ ุงุณุงุณ ุณุชูู (ูู ุฑุฏู).
'''
# ุชูุณู ุฏุงุฏู ุจู ุขููุฒุด ู ุชุณุช
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

'''
 ูุฏู ุฏุฑุฎุช ุชุตูู
'''
clf = DecisionTreeClassifier()
clf.fit(X_train, y_train)

# ูพุดโุจู
y_pred = clf.predict(X_test)

# ุฏูุช ูุฏู
print("Accuracy:", accuracy_score(y_test, y_pred))

titanic = sns.load_dataset("titanic")
print(titanic.head())
'''
ุจุฎุด ด: ุชูุฑู ฺฉูุงุณ
'''
print('ุจุฎุด ด: ุชูุฑู ฺฉูุงุณ')
titanic = sns.load_dataset("titanic")
#print(titanic)

print(titanic.head())
'''
ฺูุฏ ุณุชูู ููู (ุณูุ ุฌูุณุชุ
              ฺฉูุงุณ) ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ.

ุจุจูุฏ ฺู ุนูุงูู ุจุดุชุฑู ุชุฃุซุฑ ุฑุง 
ุฏุฑ ุฒูุฏู ูุงูุฏู (survived) ุฏุงุฑูุฏ.
'''

'''
ุฏุงุฏูโฺฉุงู ฺฉ ูุฑุขูุฏ ฺูุฏูุฑุญููโุง ุงุณุช ูู ููุท ุงุฌุฑุง ุงูฺฏูุฑุชู.

ุงุจุฒุงุฑ ุงุตู ูุง Python + pandas + scikit-learn ุฎูุงูุฏ ุจูุฏ.
'''

'''
ููุชู ุฏูู:
 
   ฺฏุฑุฏุขูุฑ ู ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง (Data Collection & Preprocessing) 

 

 ุงุฏุงูู ุทุฑุญ ุฏุฑุณ โ ฺฏุฑุฏุขูุฑ ู ุขูุงุฏูโุณุงุฒ ุฏุงุฏูโูุง

  

ุฏุฑ ูพุงุงู ุงู ุฌูุณู ุฏุงูุดุฌู ุจุงุฏ ุจุชูุงูุฏ:

1. ุงููุงุน ููุงุจุน ุฏุงุฏู ู ุง ูุญู ุฐุฎุฑู ุฏุงุฏู ุฑุง ุชุดุฎุต ุฏูุฏ (CSVุ Excelุ API).
2. ุฏุงุฏูโูุง ุฑุง ุงุฒ ูุงู ุง ุงูุชุฑูุช ุจุฎูุงูุฏ ู ุฏุฑ Python ุจุฑุฑุณ ฺฉูุฏ.
3. ุฏุงุฏูโูุง ูุงูุตุ ูพุฑุช ุง ุชฺฉุฑุงุฑ ุฑุง ุดูุงุณุง ู ุงุตูุงุญ ฺฉูุฏ.
4. ูุฑูุงูโุณุงุฒ ู ุงุณุชุงูุฏุงุฑุฏุณุงุฒ ุฏุงุฏู ุฑุง ุจุฑุง ุงูฺฏูุฑุชูโูุง ุงุฏฺฏุฑ ุงูุฌุงู ุฏูุฏ.
5. ุชูุงูุช ุจู Feature Selection ู  Feature Scaling ุฑุง ุชูุถุญ ุฏูุฏ.


  ุจุฎุด ฑ โ ููุฏููโ  

  ููุถูุนุงุช ฺฉูุฏ:

  ุฏุงุฏู ุฎุงู ุงุบูุจ ูุงูุตุ ููุฒ ู ูุงููุงููฺฏ  ุงุณุช.
 ูุฑุญููโ ูพุดโูพุฑุฏุงุฒุด ุดุงูู:

  1.  ูพุงฺฉโุณุงุฒ ุฏุงุฏู (Data Cleaning) 
  2. ุชุจุฏู ุฏุงุฏู (Transformation) 
  3. ุงูุชุฎุงุจ ูฺฺฏโูุง (Feature Selection) 
  4. ฺฉูพุงุฑฺูโุณุงุฒ ุฏุงุฏู (Integration) 

  ุฏูุงู ุงููุช:

 ูุฏูโูุง ุงุฏฺฏุฑ ูุงุดู ุจู ุฏุงุฏูโูุง ุชูุฒ ู ุนุฏุฏ ูุงุฒ ุฏุงุฑูุฏ.
 ุฏุงุฏูโูุง ูพุฑุช ูโุชูุงููุฏ ูุฏู ุฑุง ููุญุฑู ฺฉููุฏ.
 ุฏุงุฏูโูุง ฺฏูุดุฏู ุจุงุฏ ุญุฐู ุง ุฌุงฺฏุฒู ุดููุฏ (imputation).

---

ุจุฎุด ฒ โ ูุซุงูโูุง ุนูู

 ุชูุฑู ฑ: ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏู ุงุฒ CSV
'''

import pandas as pd

# ุฎูุงูุฏู ูุงู CSV
df = pd.read_csv("https://raw.githubusercontent.com/mwaskom/seaborn-data/master/titanic.csv")

print(df.head())
print(df.info())

'''
ุจุฑุง ุงุฏฺฏุฑ ู ุขุดูุง ุจุง ุณุชููโูุง ู ููุน ุฏุงุฏูโูุง.
'''
'''
 ุชูุฑู ฒ: ุจุฑุฑุณ ููุงุฏุฑ ฺฏูุดุฏู (Missing Values)


 ุดูุงุฑุด ููุงุฏุฑ ฺฏูุดุฏู ุฏุฑ ูุฑ ุณุชูู
 '''
 
print(df.isnull().sum())
'''
 ุฏุฑุตุฏ ุฏุงุฏูโูุง ฺฏูุดุฏู
 '''
print((df.isnull().sum() / len(df)) * 100)

'''
ูุชุฌู: ูุชูุฌู ูโุดูุฏ ูุซูุงู ุณุชูู "age" ุง "deck" ุฏุงุฑุง ููุงุฏุฑ ฺฏูุดุฏู ุงุณุช.
'''

'''
 ุชูุฑู ณ: ุญุฐู ู ุฌุงฺฏุฒู ุฏุงุฏูโูุง ฺฏูุดุฏู

ุฌุงฺฏุฒู ูุงูฺฏู ุจุฑุง ุณุชูู age
'''

df['age'].fillna(df['age'].mean())
'''
 ุญุฐู ุณุชููโูุง ฺฉู ุจุด ุงุฒ 50ูช ููุฏุงุฑ ฺฏูุดุฏู ุฏุงุฑูุฏ
 '''
df.dropna(thresh=len(df)*0.5, axis=1)


'''
 ุชูุฑู ด: ุดูุงุณุง ุฏุงุฏูโูุง ูพุฑุช (Outliers)
  ฑ. ุชุนุฑูโูุง
  ููุฒ (Noise)

ููุฒ ุนู ุงุฎุชูุงู ุชุตุงุฏู ู ุบุฑุณุณุชูุงุชฺฉ ุฏุฑ ุฏุงุฏู.
ุนู ููุฏุงุฑ ุงุฒ ุฏุงุฏู ฺฉู ุจูโุทูุฑ ุงุชูุงู ู ูุนูููุงู ุจู ุฏูู ุฎุทุง ุงูุฏุงุฒูโฺฏุฑุ ุซุจุช ุฏุงุฏูุ ุง ููุณุงูุงุช 
 ูุญุธูโุง ุจูโูุฌูุฏ ุขูุฏู ู ุงูฺฏู ูุงูุน ุฑุง ูุฎู ุง ุฎุฑุงุจ ูโฺฉูุฏ.

  ูฺฺฏโูุง:

ูุนูููุงู ฺฉูฺฺฉ ู ูพุฑุงฺฉูุฏู ุงุณุช.

ุฏุฑ ฺฉู ุฏุงุฏู ูพุฎุด ุดุฏูุ ูู ููุท ฺูุฏ ููุทู.

ููฺฉู ุงุณุช ุญุฐูโุดุฏู ูุจุงุดุฏุ ุจูฺฉู ุจุงุฏ ุตุงู ุง ููุชุฑ ุดูุฏ 
(ุจุง ูุงูฺฏูโฺฏุฑุ  smoothing ู ...).

  ูุซุงู:
ูุฑุถ ฺฉู ุฏูุง ุงุชุงู ุฑุง ูุฑ ุฏููู ุงูุฏุงุฒู ูโฺฏุฑุ ูู ฺฏุงู
 ุณูุณูุฑ ฺฉู ุฎุทุง ุฏุงุฑุฏ ู ฐ.ฒ ุฏุฑุฌู ุจุงูุงุชุฑ ุง ูพุงูโุชุฑ ูุดุงู ูโุฏูุฏ.
ุงู ููุณุงูุงุช ฺฉูฺฺฉ = ููุฒ ูุณุชูุฏ.

  ุงูุชูุงุฑ (Outlier)

ุงูุชูุงุฑ ุนู ููุทูโุง ฺฉู ูุณุจุช ุจู ุจููโ ุฏุงุฏูโูุง ุจูโุทูุฑ ุบุฑุนุงุฏ ุฏูุฑ ุงุณุช.
ูุนูููุงู ูุดุงูโุฏููุฏูโ ฺฉ ุงุชูุงู ูุงุฏุฑ ุง ุงุดุชุจุงู ุฎุงุต ุงุณุช 
(ูุซู ุฎุทุง ูุฑูุฏ ุฏุงุฏูุ ุง ุฑุฎุฏุงุฏ ูุงูุน ูุงุฏุฑ ูุซู ุณููุท ุดุฏุฏ ููุช ุจุชโฺฉูู).

  ูฺฺฏโูุง:

ูุนูููุงู ููุท ฺูุฏ ููุทูโ ูุฌุฒุง ูุณุชูุฏ.

ูุงุตููโ ุฒุงุฏ ุงุฒ ูุงูฺฏู ุง ุชูุฒุน ุงุตู ุฏุงุฑูุฏ.

ููฺฉู ุงุณุช ุงุทูุงุนุงุช ููู ุจุงุดูุฏ (ูุซูุงู anomaly ุฏุฑ ุชุดุฎุต ุชููุจ).

  ูุซุงู:
ุงฺฏุฑ ููุช ุจุชโฺฉูู ุฏุฑ ฺูุฏ ุฑูุฒ ุจู
 ถต ุชุง ถท ูุฒุงุฑ ุฏูุงุฑ ุจูุฏู ูู ฺฉโุฑูุฒ ูุงฺฏูุงู 
 ดฐ ูุฒุงุฑ ุซุจุช ุดุฏู ุจุงุดุฏุ ุขู ููุทู = ุงูุชูุงุฑ ุงุณุช.
 ณ. ูุซุงู ุนุฏุฏ ุณุงุฏู

ูุฑุถ ฺฉูุฏ ุฏุงุฏูโูุง ุฒุฑ ุฏูุง ุงุชุงูโุงูุฏ (ุฏุฑ ุฏุฑุฌูโ ุณุงูุชโฺฏุฑุงุฏ):

[25.1, 24.9, 25.0, 25.2, 25.1, 25.0, 40.0, 25.1, 25.0]


ุงุนุฏุงุฏ ูุซู 24.9 ุง 25.2 = ููุฒ (ููุณุงูุงุช ุทุจุน)

ุนุฏุฏ 40.0 = ุงูุชูุงุฑ (ุจูโุทูุฑ ูุงุถุญ ุงุดุชุจุงู ุง ุฑุฎุฏุงุฏ ูุงุฏุฑ)
'''

import seaborn as sns
import matplotlib.pyplot as plt

sns.boxplot(x=df['fare'])
plt.show()

# ุญุฐู ุฏุงุฏูโูุง ูพุฑุช ุดุฏุฏ
q1 = df['fare'].quantile(0.25)
q3 = df['fare'].quantile(0.75)
iqr = q3 - q1
lower, upper = q1 - 1.5*iqr, q3 + 1.5*iqr
df = df[(df['fare'] >= lower) & (df['fare'] <= upper)]

'''
ูุจู ุงุฒ ุญุฐูุ ูููุฏุงุฑ Boxplot ูพุฑ ุงุฒ ููุงุท ุฏูุฑุงูุชุงุฏู
 (ุฏุงุฑูโูุง ุฎุงุฑุฌ ุงุฒ ูุญุฏูุฏู whiskerูุง) ุงุณุช.
ุจุนุฏ ุงุฒ ุญุฐูุ ุงฺฏุฑ ุฏูุจุงุฑู ุงุฌุฑุง ฺฉูุฏ:
'''

sns.boxplot(x=df['fare'])
plt.show()

'''
ุชูุถุญ:

sns.boxplot
 ูููุฏุงุฑ Boxplot
 ุฑุง ุฑุณู ูโฺฉูุฏ ฺฉู ุจุฑุง ููุงุด ูพุฑุงฺฉูุฏฺฏ 
ุฏุงุฏูโูุง ู ููุงุท ูพุฑุช 
ุงุณุชูุงุฏู 
ูโุดูุฏ.

ูุญูุฑ x=df['fare'] ุนู ุฏุงุฏูโูุง ฺฉุฑุงู
 (Fare) ูุณุงูุฑุงู ฺฉุดุช ุชุงุชุงูฺฉ ุฑุง ุชุฑุณู ฺฉู.

  ุฏุฑ ุฎุฑูุฌ:

ูุณุชุทู ูุงู ูุดุงูโุฏููุฏู ุจุงุฒู ุจู ฺุงุฑฺฉ ุงูู
 (Q1) ู ฺุงุฑฺฉ ุณูู (Q3) ุงุณุช.

ุฎุท ูุณุท = ูุงูู ุฏุงุฏูโูุง (Median).

ููุงุท ุฎุงุฑุฌ ุงุฒ ูุญุฏูุฏู whiskerูุง โ ุฏุงุฏูโูุง ูพุฑุช (Outliers).
'''
'''
 ุชูุฑู ต: ุญุฐู ุฏุงุฏูโูุง ุชฺฉุฑุงุฑ
'''

print("ุชุนุฏุงุฏ ฺฉู ุฏุงุฏูโูุง:", len(df))
df.drop_duplicates(inplace=True)
print("ุชุนุฏุงุฏ ูพุณ ุงุฒ ุญุฐู ุชฺฉุฑุงุฑโูุง:", len(df))
 
'''
ุจุงุนุซ ูโุดูุฏ ุฑุฏูโูุง ุชฺฉุฑุงุฑ (duplicate rows) ุงุฒ ุฏุงุฏูโูุง ุญุฐู ุดููุฏ.
  len(df) ุฏุฑ ูพุงุชูู ุนู:

ุชุนุฏุงุฏ ุฑุฏูโูุง (rows) ุฏุฑ ุฌุฏูู ุฏุงุฏูโ df
'''
'''

  ุชูุฑู ถ: ุชุจุฏู ุฏุงุฏูโูุง ูุชู ุจู ุนุฏุฏ (Encoding)

'''
df['sex_encoded'] = df['sex'].map({'male': 0, 'female': 1})
print(df[['sex', 'sex_encoded']].head())
'''
ุงู ุฎุท ุงุฒ ฺฉุฏ ฺฉ ุงุฒ ููุงูู ฺฉูุฏ ุฏุฑ ูพุดโูพุฑุฏุงุฒุด ุฏุงุฏูโูุง
 (Data Preprocessing) ุฑุง ุขููุฒุด ูโุฏูุฏ:
 ุชุจุฏู ุฏุงุฏูโูุง ูุชู (categorical) ุจู ุฏุงุฏูโูุง
 ุนุฏุฏ (numerical) ุชุง ุจุชูุงู ุขูโูุง
 ุฑุง ุฏุฑ ูุฏูโูุง ุฏุงุฏูโฺฉุงู ุง ุงุฏฺฏุฑ ูุงุดู ุงุณุชูุงุฏู ฺฉุฑุฏ.
'''

'''
 ุชูุฑู ท: ูุฑูุงูโุณุงุฒ ูฺฺฏโูุง (Feature Scaling)

'''
from sklearn.preprocessing import MinMaxScaler

scaler = MinMaxScaler()
df[['age_scaled', 'fare_scaled']] = scaler.fit_transform(df[['age', 'fare']])
print(df[['age_scaled', 'fare_scaled']].head())
'''
ุงฺฏุฑ  ุฏุงุฏูโูุง ุฑุง ุจุฏูู ููุงุณโุจูุฏ ุจู ูุฏู ุงุฏฺฏุฑ ุจุฏูู:

ุณุชููโูุง ุจุง ููุงุฏุฑ ุจุฒุฑฺฏโุชุฑ (ูุซู fare) ุชุฃุซุฑ 
ุฎู ุจุดุชุฑ ุฑู ูุฏู ุฏุงุฑูุฏ.

ูุฏู ุฏฺุงุฑ ุณูฺฏุฑ ุนุฏุฏ ูโุดูุฏ.

ุจูุงุจุฑุงู ุจุงุฏ ููู ูฺฺฏโูุง ุฑุง ุฏุฑ ฺฉ ุจุงุฒู
 ุนุฏุฏ ูุดุชุฑฺฉ (ูุนูููุงู 0 ุชุง 1) ูุฑุงุฑ ุฏูู.
ุจู ุงู ฺฉุงุฑ ูโฺฏูู Min-Max Scaling.
'''

'''
  ุชูุฑู ธ: ุงุณุชุงูุฏุงุฑุฏุณุงุฒ (Standardization)

'''
from sklearn.preprocessing import StandardScaler

scaler_std = StandardScaler()
df[['age_std', 'fare_std']] = scaler_std.fit_transform(df[['age', 'fare']])
print(df[['age_std', 'fare_std']].head())

'''
ุชุจุฏู ุฏุงุฏูโูุง ุจู ููุงุณ ุจุง ูุงูฺฏู ุตูุฑ ู ุงูุญุฑุงู ูุนุงุฑ 

ูุฑูุด ุจุง MinMaxScaler ุฏุฑ ุงู ุงุณุช ฺฉู ุขู ุจู ุจุงุฒู ุฏูุฎูุงู 0 ู 1 ูุจุฑุฏ
 ุงฺฏุฑ ูโุฎูุงูู ููุงุณ ฺฉููุงุฎุช (ฐ ุชุง ฑ) ุฏุงุดุชู ุจุงุดู  
 ุงุฒ MinMaxScaler ุงุณุชูุงุฏู ูโฺฉูู.
 ุงฺฏุฑ ูโุฎูุงูู ุฏุงุฏูโูุง ูุณุจุช ุจู ูุงูฺฏู ู ูพุฑุงฺฉูุฏฺฏ ุงุณุชุงูุฏุงุฑุฏ ุดููุฏ 
 ุงุฒ StandardScaler ุงุณุชูุงุฏู ูโฺฉูู.
'''

'''
  ุชูุฑู น: ุงูุชุฎุงุจ ูฺฺฏโูุง (Feature Selection)
'''
selected_features = ['sex_encoded', 'age_scaled', 'fare_scaled', 'class', 'survived']
df_selected = df[selected_features]
print(df_selected.head())
'''
  ุชูุฑู ฑฐ: ุฐุฎุฑูโุณุงุฒ ุฏุงุฏู ุขูุงุฏูโุดุฏู

'''
df_selected.to_csv("titanic_preprocessed.csv", index=False)
print("โ ุฏุงุฏู ุชูุฒ ู ูุฑูุงูโุดุฏู ุฐุฎุฑู ุดุฏ.")


'''
  ุชูุฑูโูุง ุญู ูุดุฏู 
'''
'''
1. ุจุฑุฑุณ ฺฉูุฏ ฺูุฏ ููุฑ ุงุฒ ูุณุงูุฑุงู ฺฉูุงุณ ฑุ ฒ ู ณ 
ุฒูุฏู ูุงูุฏูโุงูุฏ ู ุฏุฑุตุฏ ุขูโูุง ุฑุง ูุญุงุณุจู ฺฉูุฏ.
2. ุณุชูู โembarkedโ ุฏุงุฑุง ููุงุฏุฑ ฺฏูุดุฏู ุงุณุช. 
ุขู ุฑุง ุจุง ููุฏุงุฑ ูพุฑุชฺฉุฑุงุฑ (mode) ุฌุงฺฏุฒู ฺฉูุฏ.
3. ุจุฑุฑุณ ฺฉูุฏ ูุงูฺฏู ุณู ูุณุงูุฑุงู ูุฑุฏ ู ุฒู ฺูุฏุฑ ุงุณุช.
4. ฺฉ ูููุฏุงุฑ scatter ุงุฒ ุฑุงุจุทูโ ุจู โageโ ู โfareโ ุฑุณู ฺฉูุฏ
 (ุฑูฺฏ ุจุฑ ุงุณุงุณ survived).
5. ุจุนุฏ ุงุฒ ูพุงฺฉโุณุงุฒุ ูุงู ุฎุฑูุฌ ุฎูุฏ ุฑุง ุฐุฎุฑู ฺฉุฑุฏู ู ุงูุฏุงุฒู
 (ุชุนุฏุงุฏ ุณุทุฑ ู ุณุชูู) ุขู ุฑุง ุจุง ูุงู ุงุตู ููุงุณู ฺฉูุฏ.
'''

'''

 ุฌูุนโุจูุฏ

 ุฏุงุฏูโฺฉุงู ุจุฏูู ูพุดโูพุฑุฏุงุฒุดุ ูุชุงุฌ ุงุดุชุจุงู ุชููุฏ ูโฺฉูุฏ.
 ูพุงฺฉโุณุงุฒุ ูุฑูุงูโุณุงุฒ ู ุงูุชุฎุงุจ
 ูฺฺฏโูุง ฺฏุงูโูุง ุถุฑูุฑ ูุณุชูุฏ.

'''
'''
ุฌูุณู ุณูู โ ุงูฺฏูุฑุชู K-Nearest Neighbors (KNN)
'''


'''
ุจุฎุด ฑ โ ููุฏูู ู ุดููุฏ ุงูฺฏูุฑุชู KNN

ููุถูุนุงุช:

ุชุนุฑู KNN: ูุฑ ุฏุงุฏูโ ุฌุฏุฏ ุฑุง ุจุง ูุฒุฏฺฉโุชุฑู ูููููโูุง ุขููุฒุด ููุงุณู ูโฺฉูุฏ.

ููููู ูุงุตูู (Euclidean distance)

ููููู K (ุชุนุฏุงุฏ ููุณุงฺฏุงู)

ุชูุงูุช bias ู variance ุฏุฑ ุงูุชุฎุงุจ K

ูุซุงู ุดููุฏ:
ุงฺฏุฑ ุจุฎูุงูุฏ ูพุดโุจู ฺฉูุฏ ฺฉ ููุฑ ุฒูุฏู ูโูุงูุฏ ุง ููุ
 ุจู ูุณุงูุฑุงู ูฺฏุงู ูโฺฉูุฏ ฺฉู ุงุฒ ูุธุฑ ุณูุ ุฌูุณ ู ฺฉูุงุณ ุดุจู ุงู ูุณุชูุฏ.

'''
'''
  ุจุฎุด ฒ โ ูุซุงู ุนูู ุฏุฑ Spyder (ุฏุชุงุณุช Iris)

'''
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier
from sklearn.metrics import accuracy_score, confusion_matrix
import seaborn as sns
import matplotlib.pyplot as plt
import pandas as pd

# ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏู
iris = load_iris()
df = pd.DataFrame(iris.data, columns=iris.feature_names)
df['target'] = iris.target

# ุชูุณู ุฏุงุฏู
X = df.iloc[:, :-1]

'''
ูุจู ุงุฒ ฺฉุงูุง :   ุนู ูููโ ุณุทุฑูุง ุฑุง ุงูุชุฎุงุจ ฺฉู.

ุจุนุฏ ุงุฒ ฺฉุงูุง :-1   ุนู ุชูุงู ุณุชููโูุง ุจู ุฌุฒ ุขุฎุฑู ุณุชูู ุฑุง ุงูุชุฎุงุจ ฺฉู.

ูพุณ:

df.iloc[:, :-1]


ุนู:


ูููโ ุฑุฏูโูุง (ุณุทุฑูุง) ุฑุง ุจฺฏุฑ ูู ููุท ุณุชููโูุง ฐ ุชุง ฺฉโูุงูุฏูโุจูโุขุฎุฑ ุฑุง ูฺฏู ุฏุงุฑ.

y = df.iloc[:, -1]    # ุขุฎุฑ ููุท ุณุชูู  
'''
y = df['target']
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# ูุฏู KNN
knn = KNeighborsClassifier(n_neighbors=5)
knn.fit(X_train, y_train)

# ูพุดโุจู
y_pred = knn.predict(X_test)

# ุฏูุช ูุฏู
print("Accuracy:", accuracy_score(y_test, y_pred))

# ูุงุชุฑุณ ุฏุฑููโุฑุฎุชฺฏ (Confusion Matrix)
cm = confusion_matrix(y_test, y_pred)
sns.heatmap(cm, annot=True, cmap="Blues", fmt="d")
plt.title("Confusion Matrix - KNN (Iris)")
plt.show()

'''
n_neighbors=5 ุนู ูุฑ ุฏุงุฏู ุฌุฏุฏ ุจุง ต ููุณุงู ูุฒุฏฺฉ ููุงุณู ูโุดูุฏ.

ุงฺฏุฑ ููุฏุงุฑ K ุฎู ฺฉูฺฺฉ ุจุงุดุฏ   ูุฏู ุญุณุงุณ ุจู ููุฒ ูโุดูุฏ.

ุงฺฏุฑ ุฎู ุจุฒุฑฺฏ ุจุงุดุฏ ูุฏู ุจุด ุงุฒ ุญุฏ ุนููู ูโุดูุฏ.

ุฎุฑูุฌ cm ฺฉ ูุงุชุฑุณ ูุฑุจุน ุงุณุช ฺฉู ุฏุฑ ุขู:

ุณุทุฑูุง ูุดุงูโุฏููุฏูโ ฺฉูุงุณ ูุงูุนโุงูุฏ

ุณุชููโูุง ูุดุงูโุฏููุฏูโ ฺฉูุงุณ ูพุดโุจูโุดุฏู ูุณุชูุฏ

ุจุง seaborn.heatmapุ ูุงุชุฑุณ ุฑุง ุจูโุตูุฑุช ููุดู ุฑูฺฏ (Heatmap) ุฑุณู ูโฺฉูู.
 annot=True ุนู ุฑู ูุฑ ุฎุงูู ููุฏุงุฑ ุนุฏุฏ ฺุงูพ ุดูุฏ.
 cmap="Blues" ุฑูฺฏ ุฒููู ุขุจ ูโุฏูุฏ.
 fmt="d" ุนู ุงุนุฏุงุฏ ุตุญุญ ฺุงูพ ุดููุฏ.

ููุฏุงุฑูุง ุฑู ูุทุฑ ุงุตู ูพุดโุจูโูุง ุฏุฑุณุช  

'''
'''
ููููู ฺฉู ูุงุชุฑุณ ุฏุฑููโุฑุฎุชฺฏ

1.ูุงุชุฑุณ ุฏุฑููโุฑุฎุชฺฏ ุงุจุฒุงุฑ ุงุณุช ุจุฑุง 
ุงุฑุฒุงุจ ุนููฺฉุฑุฏ ูุฏูโูุง ุทุจููโุจูุฏ (Classification).
ุงู ูุงุชุฑุณ ูุดุงู ูโุฏูุฏ ฺฉู ูุฏู ุฏุฑ ูุฑ ฺฉูุงุณุ ฺูุฏ 
ููููู ุฑุง ุฏุฑุณุช ุง ุงุดุชุจุงู ูพุดโุจู ฺฉุฑุฏู ุงุณุช.

  ฒ. ุณุงุฎุชุงุฑ ูุงุชุฑุณ

ุฏุฑ ุงู ูุซุงูุ ฺูู ุฏุชุงุณุช Iris
 ุดุงูู ณ ููุน ฺฏู ุงุณุช:

0 โ Iris-setosa

1 โ Iris-versicolor

2 โ Iris-virginica

ูพุณ ูุงุชุฑุณ ฺฉุงูููฺู ูุง ณรณ ุงุณุช:

	Predicted: 0	Predicted: 1	Predicted: 2
Actual: 0	aโโ	aโโ	aโโ
Actual: 1	aโโ	aโโ	aโโ
Actual: 2	aโโ	aโโ	aโโ

  ูุฑ ุฎุงููโ aแตขโฑผ ูุดุงู ูโุฏูุฏ
 ฺูุฏ ููููู ุงุฒ ฺฉูุงุณ i ูุงูุนุงู
 ูุชุนูู ุจู ฺฉูุงุณ i ุจูุฏูโุงูุฏ
ูู ูุฏู ุขูโูุง ุฑุง ุจู ุงุดุชุจุงู
 ฺฉูุงุณ j ูพุดโุจู ฺฉุฑุฏู ุงุณุช.
ณ. ุฏุฑ ฺฉุฏ ฺู ุงุชูุงู ูโุงูุชุฏ
cm = confusion_matrix(y_test, y_pred)


y_test โ ููุงุฏุฑ ูุงูุน ฺฉูุงุณโูุง (ูุงูุนุช)

y_pred โ ุฎุฑูุฌ ูุฏู (ูพุดโุจู)

ุชุงุจุน confusion_matrix ุชุนุฏุงุฏ ูพุดโุจูโูุง ุฏุฑุณุช 
ู ุบูุท ุฑุง ุฏุฑ ูุงูุจ ฺฉ ุขุฑุงู ณรณ ูโุฏูุฏ.
ด. ุจุฎุด ุชุฑุณู (Visualization)
sns.heatmap(cm, annot=True, cmap="Blues", fmt="d")
plt.title("Confusion Matrix - KNN (Iris)")
plt.show()


sns.heatmap ูุงุชุฑุณ ุฑุง
 ุจูโุตูุฑุช ููุดู ุญุฑุงุฑุช (Heatmap) ููุงุด ูโุฏูุฏ.

annot=True ุนู ููุงุฏุฑ ุนุฏุฏ ุฑู
 ุณูููโูุง ููุดุชู ูโุดููุฏ.

cmap="Blues" ุนู ุดุฏุช ุฑูฺฏ ุขุจุ 
ูุฒุงู ุฏุฑุณุช ุง ุงุดุชุจุงู
 ุฑุง ูุดุงู ูโุฏูุฏ.

ุฑูฺฏ ุชุฑูโุชุฑ โ ููุฏุงุฑ ุจุดุชุฑ


ุฑูฺฏ ุฑูุดูโุชุฑ โ ููุฏุงุฑ ฺฉูุชุฑ

ต. ุชูุณุฑ ูููุฏุงุฑ

ุฏุฑ ูููุฏุงุฑ ุญุงุตู:

ูุทุฑ ุงุตู ูุงุชุฑุณ (ุงุฒ ุจุงูุง ฺูพ ุชุง ูพุงู ุฑุงุณุช)
ูุดุงูโุฏููุฏูโ ุชุนุฏุงุฏ ูพุดโุจูโูุง ุฏุฑุณุช ุงุณุช.
(ุนู ูุฏู ฺฉูุงุณ ุฑุง ุฏุฑุณุช ุชุดุฎุต ุฏุงุฏู ุงุณุช.)

ุฎุงููโูุง ุฎุงุฑุฌ ุงุฒ ูุทุฑ
ุจุงูฺฏุฑ ุชุนุฏุงุฏ ุงุดุชุจุงูุงุช ูุฏู ูุณุชูุฏ.
ูุฑ ุนุฏุฏ ุฏุฑ ุฎุงุฑุฌ ุงุฒ ูุทุฑ ูุดุงู ูโุฏูุฏ ูุฏู ฺูุฏุฑ ุฏู ฺฉูุงุณ ุฑุง ุจุง ูู ุงุดุชุจุงู ฺฏุฑูุชู ุงุณุช.

ูุซุงู ูุฑุถ:

ุงฺฏุฑ ุฎุฑูุฌ ูุงุชุฑุณ ุงู ุจุงุดุฏ:

	0	1	2
0	10	0	0
1	0	9	1
2	0	1	9

  ูุฏู ุชูุงู ฺฏูโูุง ฺฉูุงุณ 0 ุฑุง ุฏุฑุณุช ุชุดุฎุต ุฏุงุฏู.
  ููุท ฒ ููุฑุฏ ุจู ฺฉูุงุณ 1 ู 2 ุงุดุชุจุงู ฺฏุฑูุชู ุดุฏู.
  ูพุณ ุนููฺฉุฑุฏ ูุฏู ุจุณุงุฑ ุฎูุจ ุงุณุช.

  ูุชุฌูโฺฏุฑ

  ูุงุชุฑุณ ุฏุฑููโุฑุฎุชฺฏ ุงุจุฒุงุฑ ุฏููโุชุฑ 
ุงุฒ โAccuracyโ ุงุณุชุ ฺูู ูุดุงู ูโุฏูุฏ
 ฺฉุฏุงู ฺฉูุงุณโูุง ุงุดุชุจุงู ฺฏุฑูุชู ุดุฏูโุงูุฏ.
  ูููุฏุงุฑ ุขู ุจู ูุง ุฏุฑฺฉ ุจุตุฑ ุงุฒ
 ุนููฺฉุฑุฏ ูุฏู ุฑู ูุฑ ฺฉูุงุณ ุฑุง ูโุฏูุฏ.
  ูุฑ ฺู ุฑูฺฏโูุง ูุทุฑ ุงุตู ุชุฑูโุชุฑ ุจุงุดูุฏุ
 ุนู ูุฏู ุจูุชุฑ ุนูู ฺฉุฑุฏู ุงุณุช.
ุฏุฑ ูุซุงู ูุง ฺฉู ุฑุณู ฺฉุฑุฏู ุงู ฺฉูุง 30 ุฏุงุฏู ุชุณุช ุจุฑุฑุณ ุดุฏู
'''



'''
ุจุฎุด ณ โ ุงูุชู ุจูุชุฑู ููุฏุงุฑ K
'''

from sklearn.model_selection import cross_val_score
import numpy as np

scores = []
for k in range(1, 21):
    knn = KNeighborsClassifier(n_neighbors=k)
    knn.fit(X_train, y_train)
    scores.append(knn.score(X_test, y_test))

plt.plot(range(1, 21), scores, marker='o')
plt.xlabel("K value")
plt.ylabel("Accuracy")
plt.title("Finding Optimal K")
plt.show()


'''
ฺฉุฏ ุจุงูุง ุจุฑุง ุงูุชุฎุงุจ ููุฏุงุฑ ุจูููโ K ุฏุฑ ุงูฺฏูุฑุชู
 K-Nearest Neighbors (KNN) ููุดุชู ุดุฏู ุงุณุช.
ุนู ูโุฎูุงูู ุจูููู:

ฺูุฏ "ููุณุงู" ุจุฑุง KNN ุจูุชุฑู ุฏูุช ุฑุง ุฑู ุฏุงุฏูโูุง ูโุฏูุฏุ
'''


'''
ุฌูุณู ุจุนุฏ
'''
'''
ููุถูุน:
ููููู ุจุฒ ู ุงุญุชูุงู ุดุฑุท ูุฑูุฑ ูโุดูุฏุ

ุณูพุณ ุจุฒ ุณุงุฏู ูุนุฑู ูโฺฏุฑุฏุฏุ

ุงููุงุน ุขู (Gaussian, Multinomial, Bernoulli Naive Bayes) ุจุง ูุซุงู ุจุฑุฑุณ ูโุดููุฏุ

ู ุฏุฑ ุงูุชูุง ุจุง ุฏุชุงุณุช ูุนุฑูู Iris ุง Titanic ุชูุฑู ุนูู ุงูุฌุงู ูโุฏูู.
'''

'''

ุงูฺฏูุฑุชู ุจุฒ ุณุงุฏู (Naive Bayes Classifier)
  ุงูุฏุงู ุขููุฒุด:

ุฏุฑ ูพุงุงู ุงู ุฌูุณูุ ุฏุงูุดุฌูุงู ุจุงุฏ ุจุชูุงููุฏ:

ููููู ุงุญุชูุงู ุดุฑุท ุฑุง ุชูุถุญ ุฏููุฏ.

ูุงููู ุจุฒ (Bayesโ Theorem) ุฑุง ุจููุณูุฏ ู ุชูุณุฑ ฺฉููุฏ.

ุงุฏูโ ยซุณุงุฏู ุจูุฏูยป ุฏุฑ Naive Bayes ุฑุง ุฏุฑฺฉ ฺฉููุฏ (ูุฑุถ ุงุณุชููุงู ูฺฺฏโูุง).

ุงููุงุน ุงูฺฏูุฑุชูโูุง ุจุฒ ุณุงุฏู ุฑุง ุจุดูุงุณูุฏ:

Gaussian Naive Bayes

Multinomial Naive Bayes

Bernoulli Naive Bayes

ุจุชูุงููุฏ ูุฏู Naive Bayes ุฑุง ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉุชุงุจุฎุงููโ sklearn ุฑู ุฏุงุฏูโูุง ูุซู Iris ุง Titanic ูพุงุฏูโุณุงุฒ ฺฉููุฏ.

ุฏูุช ู ฺฉุงุฑุง ูุฏู ุฑุง ุจุง Confusion Matrix ู Accuracy ุงุฑุฒุงุจ ฺฉููุฏ.

  ููุงูู ุชุฆูุฑฺฉ ุฌูุณู:

ูุงููู ุงุญุชูุงู ุดุฑุท:
P(A โฉ B)/P(B)=P(A|B)

ูุงููู ุจุฒ:
(P(XโฃC).P(C))/P(X)=P(CโฃX)
 
P(CโฃX): ุงุญุชูุงู ุชุนูู ููููู X ุจู ฺฉูุงุณ C

P(XโฃC): ุงุญุชูุงู ูุดุงูุฏู ูฺฺฏโูุง ุฏุฑ ฺฉูุงุณ C

P(C): ุงุญุชูุงู ูพุดู (Prior Probability)

P(X): ุงุญุชูุงู ฺฉู ููููู



    ุงููุงุน Naive Bayes:

GaussianNB: ุฏุงุฏูโูุง ุนุฏุฏ ุจุง ุชูุฒุน ูุฑูุงู

MultinomialNB: ุฏุงุฏูโูุง ุดูุงุฑุด (ูุซู ุชุนุฏุงุฏ ฺฉููุงุช ุฏุฑ ูุชูู)

BernoulliNB: ุฏุงุฏูโูุง ุฏูุฏู (ูุซู ุจูู/ุฎุฑุ ฐ/ฑ)

  ุจุฎุด ุนูู:

ูุซุงู: ุทุจููโุจูุฏ ุฏุงุฏูโูุง Titanic ุจุง GaussianNB

'''

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.naive_bayes import GaussianNB
from sklearn.metrics import accuracy_score, confusion_matrix
import seaborn as sns
import matplotlib.pyplot as plt

# ุฏุงุฏูโูุง
df = pd.read_csv("https://raw.githubusercontent.com/mwaskom/seaborn-data/master/titanic.csv")
df = df[['sex', 'age', 'fare', 'class', 'survived']].dropna()
df['sex'] = df['sex'].map({'male':0, 'female':1})
df['class'] = df['class'].map({'First':1, 'Second':2, 'Third':3})

X = df[['sex','age','fare','class']]
y = df['survived']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

model = GaussianNB()
model.fit(X_train, y_train)
y_pred = model.predict(X_test)

# ุงุฑุฒุงุจ
print("Accuracy:", accuracy_score(y_test, y_pred))

cm = confusion_matrix(y_test, y_pred)
sns.heatmap(cm, annot=True, cmap='Blues', fmt='d')
plt.title("Confusion Matrix - Naive Bayes (Titanic)")
plt.show()


'''
ฑ. ุงุฏูโ ุงุตู ุงูฺฏูุฑุชู Naive Bayes

ุงูฺฏูุฑุชู Naive Bayes ุจุฑ ูพุงูโ ูุงููู ุจุฒ (Bayes' Theorem) ฺฉุงุฑ ูโฺฉูุฏ.

                                          ุงู ูุงููู ุฏุฑ ุขูุงุฑ ูโฺฏูุฏ:
                                              
(P(B|A).P(A))/P(B)=P(A|B)

	
ุนู:

ุงุญุชูุงู ูููุน A ุจุง ุฏุงูุณุชู ุงูฺฉู B ุฑุฎ ุฏุงุฏู ุงุณุช =
ุงุญุชูุงู ูููุน B ุฏุฑ ุตูุฑุช ุฑุฎุฏุงุฏ A ร ุงุญุชูุงู ุงูููโ A
ุชูุณู ุจุฑ ุงุญุชูุงู ฺฉู B.

  ุฏุฑ ุฏุงุฏูโฺฉุงู:

ุฏุฑ ุฒูููโ ุทุจููโุจูุฏุ ูุฑุถ ฺฉูุฏ ูโุฎูุงูู ุจุฏุงูู ฺฉ ูุณุงูุฑ Titanic ุฒูุฏู ูุงูุฏู ุง ูู.

๐(Survived|Features)=?

ุงู ุนู:

ุงุญุชูุงู ุงูฺฉู ฺฉ ููุฑ ุฒูุฏู
 ูุงูุฏู ุจุงุดุฏ ุจุง ุชูุฌู ุจู ูฺฺฏโูุงุด
 (ุณูุ ุฌูุณุชุ ฺฉุฑุงู ู ฺฉูุงุณ ุณูุฑ) ฺูุฏุฑ ุงุณุชุ

  ฒ. ูุงฺู โNaiveโ ุนู ฺูุ

ฺฉูููโ Naive ุนู ุณุงุฏูโููุญุงูู ุง ุณุงุฏูโุณุงุฒโุดุฏู.
ฺุฑุงุ ฺูู ุงู ุงูฺฏูุฑุชู ูุฑุถ ูโฺฉูุฏ ฺฉู ุชูุงู ูฺฺฏโูุง ุงุฒ ูู ูุณุชูู ูุณุชูุฏ.

ุจุฑุง ูุซุงู ุฏุฑ Titanic ูุฑุถ ูโฺฉูุฏ:

ุฌูุณุชุ ุณูุ ฺฉุฑุงูุ ู ฺฉูุงุณ ุณูุฑ ูุณุชูู ุงุฒ ููโุงูุฏ.

ุฏุฑ ูุงูุนุช ุงู ูุฑุถ ฑฐฐูช ุฏุฑุณุช ูุณุชุ ุงูุง ุจุง ุงู ูุฌูุฏ ุนููฺฉุฑุฏ ุงู ูุฏู ุจุณุงุฑ ุฎูุจ ุงุณุช!

  ณ. Gaussian Naive Bayes ุนู ฺูุ

ูุณุฎูโูุง ูุฎุชูู ุงุฒ ุจุฒ ุณุงุฏู ุฏุงุฑู:

BernoulliNB โ ุจุฑุง ุฏุงุฏูโูุง ุฏูุฏู (ฐ ุง ฑ)

MultinomialNB โ ุจุฑุง ุฏุงุฏูโูุง ุดูุงุฑุด (ูุซู ุชุนุฏุงุฏ ฺฉููุงุช ุฏุฑ ูุชู)

GaussianNB โ ุจุฑุง ุฏุงุฏูโูุง ูพูุณุชู (ุนุฏุฏ)  

ุฏุฑ ูุฏู GaussianNB ูุฑุถ ูโุดูุฏ ฺฉู ูฺฺฏโูุง ุนุฏุฏ (ูุซู age ุง fare)
ุงุฒ ุชูุฒุน ูุฑูุงู (ฺฏุงูุณ) ูพุฑู ูโฺฉููุฏ.

  ุนู:

ุงฺฉุซุฑ ุฏุงุฏูโูุง ุฏุฑ ุงุทุฑุงู ูุงูฺฏู ูุฑุงุฑ ุฏุงุฑูุฏ

ูุฑ ฺู ุงุฒ ูุงูฺฏู ุฏูุฑุชุฑ ุดูู ุงุญุชูุงู ฺฉูุชุฑ ูโุดูุฏ
(ุดุจู ููุญู ุฒูฺฏูููโุง ุดฺฉู)

  ด. ูุฑููู ุงุญุชูุงู ุฏุฑ Gaussian Naive Bayes
ุฏุฑ ฺฉุชุงุจูุง ุขูุงุฑ ููุฌูุฏ ุงุณุช.

  ต. ูุฑุงุญู ฺฉุงุฑ GaussianNB

ุงุฏฺฏุฑ (Training)
ุจุฑุง ูุฑ ฺฉูุงุณ (ูุซูุงู survived=0 ู survived=1):

ูุงูฺฏู ู ูุงุฑุงูุณ ูุฑ ูฺฺฏ ูุญุงุณุจู ูโุดูุฏ.

ุงุญุชูุงู ุงูููโ ูุฑ ฺฉูุงุณ 
P(y)
 ูู ุงุฒ ูุณุจุช ูููููโูุง ุจู ฺฉู ุฏุงุฏูโูุง ุจูโุฏุณุช ูโุขุฏ.

ูพุดโุจู (Prediction)
ุจุฑุง ุฏุงุฏูโ ุฌุฏุฏุ ุงุญุชูุงู ุชุนูู ุขู ุจู ูุฑ ฺฉูุงุณ ูุญุงุณุจู ูโุดูุฏ
ู ูุฏู ฺฉู ุงุญุชูุงู ุจุดุชุฑ ุฏุงุฑุฏุ ุจูโุนููุงู ุฎุฑูุฌ ุงูุชุฎุงุจ ูโุดูุฏ.

  ถ. ูุฒุงุง ู ูุนุงุจ GaussianNB
ูุฒุงุง                                               	ูุนุงุจ         
ุจุณุงุฑ ุณุฑุน ู ุณุจฺฉ                       ูุฑุถ ุงุณุชููุงู ูฺฺฏโูุง ูุนูููุงู ูุงุฏุฑุณุช ุงุณุช
ูุงุฒ ฺฉู ุจู ุฏุงุฏู                       	ุนููฺฉุฑุฏ ุถุนู ุงฺฏุฑ ุฏุงุฏูโูุง ุงุฒ ูุฑูุงู ูพุฑู ูฺฉููุฏ
ููุงูู ุฏุฑ ุจุฑุงุจุฑ ุฏุงุฏูโูุง ฺฉูฺฺฉ ู ููุฒ                        	ููฺฉู ุงุณุช ุจุดโุณุงุฏูโุณุงุฒ ฺฉูุฏ
ูุงุจู ุชูุณุฑ ู ูพุงุฏูโุณุงุฒ ุขุณุงู               	ููโุชูุงูุฏ ุฑูุงุจุท ูพฺุฏู ุจู ูฺฺฏโูุง ุฑุง ุจุงููุฒุฏ
  ูุซุงู ุงุฒ Titanic

ูฺฺฏโูุง:

ุฌูุณุช (sex)

ุณู (age)

ฺฉุฑุงู (fare)

ฺฉูุงุณ (class)

ูุฏู ูโฺฏูุฏ ูุซูุงู:

ุงุญุชูุงู ุฒูุฏู ูุงูุฏู ุฎุงููโูุง ุฌูุงู ุจุง ฺฉุฑุงูโ ุจุงูุง ุฏุฑ ฺฉูุงุณ ฑ ุจุดุชุฑ ุงุฒ ุจูู ุงุณุช.

  ูุชุฌู ููุง

ูุฏู GaussianNB:

ฺฉ ุงุฒ ุณุงุฏูโุชุฑู ู ุณุฑุนโุชุฑู ูุฏูโูุง ุทุจููโุจูุฏ ุงุณุชุ

ุจุฑุง ุฏุงุฏูโูุง ุนุฏุฏ ุจุง ุชูุฒุน ุชูุฑุจุงู ูุฑูุงู ุจุณุงุฑ ููุงุณุจ ุงุณุชุ

ุฏุฑ ุจุณุงุฑ ุงุฒ ูุณุงุฆู ูุงูุน (ูุซู ููุชุฑ ุงููุ ูพุดโุจู ุจูุงุ ุชุญูู ุงุญุณุงุณุงุช) ฺฉุงุฑุจุฑุฏ ุฏุงุฑุฏ.

'''
'''
 
ุงฺฉููู ุฏู ูุฏู  Naive Bayes ูโุณุงุฒู:

  ฺฉ ุจุง  BernoulliNB (ุจุฑุง ุฏุงุฏูโูุง ุฏูุฏู ูุซู ฐ ู ฑ)
  ฺฉ ุจุง  MultinomialNB ุงุณุช ู ุจุฑุง ุฏุงุฏูโูุง ุดูุงุฑุด ุง ูุซุจุช ฺฉุงุฑุจุฑุฏ ุฏุงุฑู)


 ูุซุงู ุขููุฒุด ฑ โ ูุฏู BernoulliNB

ุงู ูุฏู ุจุฑุง ุฏุงุฏูโูุง ููุงุณุจ ุงุณุช ฺฉู ูฺฺฏโูุง ุจุงูุฑ (ฐ ุง ฑ) ูุณุชูุฏุ
 ูุซูุงู ูุฌูุฏ ุง ุนุฏู ูุฌูุฏ ฺฉ ูฺฺฏ ุฏุฑ ูุชูุ ุชุตูุฑุ ุง ุญุณฺฏุฑ.
'''

from sklearn.datasets import load_breast_cancer
from sklearn.model_selection import train_test_split
from sklearn.naive_bayes import BernoulliNB
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report
import seaborn as sns
import matplotlib.pyplot as plt

# --- 1. ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏู ---
data = load_breast_cancer()
#df = pd.DataFrame(data.data, columns=data.feature_names)
#print(df)

X = data.data
y = data.target

# --- 2. ุจุงูุฑ ฺฉุฑุฏู ุฏุงุฏู ุจุฑุง BernoulliNB ---
# ุงู ูุฏู ุฏุงุฏูโูุง 0 ู 1 ูโุฎูุงูุฏุ ูพุณ ุงุฒ ุขุณุชุงูู ุงุณุชูุงุฏู ูโฺฉูู
import numpy as np
X_bin = (X > np.median(X, axis=0)).astype(int)

# --- 3. ุชูุณู ุฏุงุฏู ---
X_train, X_test, y_train, y_test = train_test_split(X_bin, y, test_size=0.2, random_state=42)

# --- 4. ุณุงุฎุช ู ุขููุฒุด ูุฏู ---
model = BernoulliNB()
model.fit(X_train, y_train)

# --- 5. ูพุดโุจู ---
y_pred = model.predict(X_test)

# --- 6. ุงุฑุฒุงุจ ---
print("Accuracy:", accuracy_score(y_test, y_pred))
print(classification_report(y_test, y_pred))

# --- 7. ููุงุด ูุงุชุฑุณ ุฏุฑููโุฑุฎุชฺฏ ---
cm = confusion_matrix(y_test, y_pred)
sns.heatmap(cm, annot=True, fmt='d', cmap='Greens')
plt.title("Confusion Matrix - BernoulliNB")
plt.xlabel("Predicted")
plt.ylabel("Actual")
plt.show()

'''

ุชูุถุญ ุขููุฒุด :

 ุงู ูุฏู ูุฑุถ ูโฺฉูุฏ ูฺฺฏโูุง ูุณุชููโุงูุฏ.
 ฺูู ุฏุงุฏูโูุง ฐ ู ฑ ูุณุชูุฏุ ุจุฑุง ูุฑ ูฺฺฏ ุงุญุชูุงู ุญุถูุฑ (ฑ)
 ู ุนุฏู ุญุถูุฑ (ฐ) ุฏุฑ ูุฑ ฺฉูุงุณ ุฑุง ูุญุงุณุจู ูโฺฉูุฏ.
 ฺฉุงุฑุจุฑุฏูุง: ุชุดุฎุต ุงุณูพูุ ุชุดุฎุต ุงุญุณุงุณุงุช ูุซุจุช/ููู ุฏุฑ ูุชูุ ุชุญูู ฺฉูุฏูุงฺูโูุง.



ุงู ฺูุงุฑ ูุนุงุฑ ููู ุฏุฑ ุงุฑุฒุงุจ ูุฏูโูุง ุทุจููโุจูุฏ ูุณุชูุฏ:

1. Precision (ุฏูุช): ูุณุจุช ูููููโูุง ุฏุฑุณุช ูพุดโุจู ุดุฏู ุฏุฑ ุขู 
ฺฉูุงุณ ุจู ฺฉู ูููููโูุง
 ฺฉู ูุฏู ุขู ฺฉูุงุณ 
ุฑุง ูพุดโุจู ฺฉุฑุฏู ุงุณุช.
2. Recall (ุจุงุฒุฎูุงู ุง ุญุณุงุณุช): ูุณุจุช ูููููโูุง ุฏุฑุณุช ูพุดโุจู ุดุฏู 
ุฏุฑ ุขู ฺฉูุงุณ ุจู ฺฉู ูููููโูุง ูุงูุน ุขู ฺฉูุงุณ.
3. F1-score: ูุงูฺฏู ูุงุฑูููฺฉ
 Precision ู Recall ฺฉู ุชุนุงุฏู ุจู ุขูโูุง ุฑุง ูุดุงู ูโุฏูุฏ:
  
4. Support (ุชุนุฏุงุฏ ูููููโูุง): ุชุนุฏุงุฏ ูุงูุน ูููููโูุง ฺฉู ุจู ูุฑ ฺฉูุงุณ ุชุนูู ุฏุงุฑูุฏ.

ุงู ฺูุงุฑ ููุฏุงุฑ ูุนูููุงู ุฏุฑ ุฌุฏูู
 `classification_report` ููุงุด ุฏุงุฏู ูโุดููุฏ ู ฺฉูฺฉ ูโฺฉููุฏ
 ุนููฺฉุฑุฏ ูุฏู ุฑุง ุจุฑุง ูุฑ ฺฉูุงุณ ุจูโุตูุฑุช ุฏูู ุงุฑุฒุงุจ ฺฉูู.


  ูุซุงู ุขููุฒุด ฒ โ ูุฏู MultinomialNB 

ุงู ูุฏู ุจุฑุง ุฏุงุฏูโูุง ุนุฏุฏ ู ูุซุจุช (ุดูุงุฑุด ูฺฺฏโูุง) ููุงุณุจ ุงุณุชุ ูุซู ุชุนุฏุงุฏ ุชฺฉุฑุงุฑ ูุงฺูโูุง ุฏุฑ ูุชู.

X > np.median(...) : ฺฉ ุขุฑุงูโ Boolean ุจุฑูโฺฏุฑุฏุงูุฏ:

ุงฺฏุฑ ููุฏุงุฑ ูุฑ ุณููู ุจุฒุฑฺฏโุชุฑ ุงุฒ ูุงูู ุณุชูู ุฎูุฏุด ุจุงุดุฏ : True

ุงฺฏุฑ ฺฉูฺฺฉุชุฑ ุง ูุณุงู ูุงูู ุจุงุดุฏ : False

ูุซุงู ุณุงุฏู:

X[:, 0] = [1, 3, 5, 7]
np.median(X[:, 0]) = 4
X[:, 0] > 4 : [False, False, True, True]
ุจุฎุด .astype(int)

ุขุฑุงู Boolean (True/False) ุฑุง ุจู ฐ ู ฑ ุชุจุฏู ูโฺฉูุฏ:

True : 1

False: 0

ูุชุฌู ููุง ุจุฑุง ูุซุงู ุจุงูุง:

[0, 0, 1, 1]



1. ุชูุณุฑ ฺฉุงูู ุฎุฑูุฌ ูุฏู BernoulliNB


Accuracy: 0.956140350877193

              precision    recall  f1-score   support

           0       0.91      0.98      0.94        43
           1       0.99      0.94      0.96        71

    accuracy                           0.96       114
   macro avg       0.95      0.96      0.95       114
weighted avg       0.96      0.96      0.96       114


ุงู ูุชุงุฌ ูุฑุจูุท ุจู ุชุดุฎุต ุณุฑุทุงู ูพุณุชุงู (ูุงูฺฏููุช=0ุ ุจูุงู=1) 
ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏู Naive Bayes ููุน Bernoulli ุงุณุช.


 Accuracy = 0.956 โ ูุฏู ุญุฏูุฏ 96ูช ุฏุฑุณุช ูพุดโุจู ูโฺฉูุฏ

ุนู ุงุฒ 114 ููููู ุชุณุชุ ุญุฏูุฏ 109 ููุฑุฏ ุฑุง
 ุฏุฑุณุช ู 5 ููุฑุฏ ุฑุง ุงุดุชุจุงู ุชุดุฎุต ุฏุงุฏู ุงุณุช.


ุชูุณุฑ ฺฉูุงุณ 0 (ุณุฑุทุงู ุจุฏุฎู โ Malignant)

 precision=0.91 : 91ูช ุงุฒ ููุงุฑุฏ ฺฉู ูุฏู ฺฏูุช "ุจุฏุฎู ูุณุชูุฏ" ูุงูุนุงู ุจุฏุฎู ุจูุฏูุฏ ; (9ูช ูุดุฏุงุฑ ุงุดุชุจุงู) |
 recall=0.98  : ูุฏู 98ูช ููุงุฑุฏ ุจุฏุฎู ูุงูุน ุฑุง ฺฉุดู ฺฉุฑุฏู ุงุณุช  ; ุจุณุงุฑ ุนุงู        |
 f1=0.94  : ุชุฑฺฉุจ ุนููฺฉุฑุฏ ุฎูุจ ุฏุฑ precision ู recall      ุชูุณุฑ:

ูุฏู ุชูุฑุจุงู ุชูุงู ุจูุงุฑุงู ุจุฏุฎู ุฑุง ูพุฏุง ฺฉุฑุฏู (98ูช).
ุงู ุจุฑุง ฺฉ ุณุณุชู ูพุฒุดฺฉ ุจุณุงุฑ ููู ุงุณุช.

ุชูุณุฑ ฺฉูุงุณ 1 (ุณุฑุทุงู ุฎูุดโุฎู โ Benign)

 precision=0.99  99ูช ููุงุฑุฏ ฺฉู ูุฏู ฺฏูุช "ุฎูุดโุฎู ูุณุชูุฏ"ุ ูุงูุนุงู ุฎูุดโุฎู ุจูุฏูุฏ  ุนุงู  
recall=0.94  : 94ูช ุฎูุดโุฎูโูุง ุฑุง ุฏุฑุณุช ุชุดุฎุต ุฏุงุฏู        ุฎูุจ   
f1=0.96:    ุนููฺฉุฑุฏ ฺฉู ุจุณุงุฑ ุจุงูุง                                     

  ุชูุณุฑ:

ูุฏู ุฏุฑ ุชุดุฎุต ุฎูุดโุฎูโูุง ูู ุจุณุงุฑ ุฎูุจ ฺฉุงุฑ ฺฉุฑุฏู.


 Macro Avg:

ูุงูฺฏู ุณุงุฏู ุจู ุฏู ฺฉูุงุณ
(ุจุฑุง ุฒูุงู ฺฉู ุฏุงุฏู ูุงูุชูุงุฒู ุจุงุดุฏ ููุงุณุจ ุงุณุช):

  precision = 0.95
  recall = 0.96
  f1 = 0.95

ูุนู:
ุนููฺฉุฑุฏ ูุฏู ุฏุฑ ูุฑ ุฏู ฺฉูุงุณ ุนุงู ุงุณุช ู ูฺ ฺฉูุงุณ ุฑุง ูุฏุง ูฺฉุฑุฏู.

 

:ูุชุฌู ููุง ุชูุณุฑ

ูุฏู BernoulliNB (ุจุง ุฏุงุฏูโูุง ุฏูุฏู ุดุฏู):

  ุนููฺฉุฑุฏ ุจุณุงุฑ ุฎูุจ (Accuracy โ 96%)
  ุชุดุฎุต ุนุงู ุณุฑุทุงู ุจุฏุฎู (Recall=98%)
  ุงุดุชุจุงูุงุช ุจุณุงุฑ ฺฉู
  ุจูโุตูุฑุช ฺฉู ููุงุณุจ ุจุฑุง ุบุฑุจุงูโฺฏุฑ ุงููู

 

2. ุชูุณุฑ ูุงุชุฑุณ ุฏุฑููโุฑุฎุชฺฏ (Confusion Matrix)

  ูุนู:

 ูุฏู 42 ุจุฏุฎู ุฑุง ุฏุฑุณุช ุดูุงุฎุช
  ูุฏู 67 ุฎูุดโุฎู ุฑุง ุฏุฑุณุช ุดูุงุฎุช
1 ุงุดุชุจุงู: ุฎูุดโุฎู ุฑุง ุจุฏุฎู ุชุดุฎุต ุฏุงุฏู (False Positive)
4 ุงุดุชุจุงู: ุจุฏุฎู ุฑุง ุฎูุดโุฎู ุชุดุฎุต ุฏุงุฏู (False Negative) ; ูููโุชุฑ 

 

3. ุชูุถุญ ุฎุท ฺฉุฏ ุจุณุงุฑ ููู

 
X_bin = (X > np.median(X, axis=0)).astype(int)
 

ุงู ฺฉ ุงุฒ ูููโุชุฑู ุจุฎุดโูุง ฺฉุฏ ุงุณุช.

  ฺุฑุง ุงู ฺฉุงุฑ ูุงุฒู ุจูุฏุ

ูุฏู BernoulliNB ููุท ุฏุงุฏูโูุง 0 ุง 1 ูุจูู ูโฺฉูุฏ.
ุงูุง ูฺฺฏโูุง breast cancer ุนุฏุฏ ู ูพูุณุชู ูุณุชูุฏ.

ุจูุงุจุฑุงู ุจุงุฏ ุฏุงุฏู ุฑุง ุจู ุจุงูุฑ ุชุจุฏู ฺฉูู.

 1) ูุญุงุณุจู ูุงูู ูุฑ ูฺฺฏ
 
np.median(X, axis=0)
 

  ุณุชููโุจูโุณุชูู ูุงูู ุญุณุงุจ ูโฺฉูุฏ
  ุจุฑุง 30 ูฺฺฏ โ 30 ููุฏุงุฑ ูุงูู
 

  (2) ููุงุณู ููุฏุงุฑ ูุฑ ููููู ุจุง ูุงูู

(X > median)
 

ุงฺฏุฑ ููุฏุงุฑ ูฺฺฏ ุจุฒุฑฺฏโุชุฑ ุงุฒ ูุงูู ุจุงุดุฏ : True
ุงฺฏุฑ ฺฉูฺฺฉโุชุฑ ุง ูุณุงู ุจุงุดุฏ : False



 (3) ุชุจุฏู True/False ุจู 0/1


.astype(int)



 True: 1
  False : 0

---

  ูุชุฌู ุฎุท ฺฉุฏ:
ูุฑ ูฺฺฏ ุชุจุฏู ุดุฏ ุจู ฺฉ ูฺฺฏ ุจุงูุฑ (0 ุง 1)
ุนู:

  ุงฺฏุฑ ูฺฺฏ ุจุงูุง ุญุฏ ูุฑูุงู ุจุงุดุฏ :1
  ุงฺฏุฑ ูพุงู ูุฑูุงู ุจุงุดุฏ : 0

ุงู ุจุฑุง ูุฏู BernoulliNaiveBayes ุถุฑูุฑ ุงุณุช.


'''

from sklearn.datasets import fetch_20newsgroups
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.model_selection import train_test_split
from sklearn.naive_bayes import MultinomialNB
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report
import seaborn as sns
import matplotlib.pyplot as plt
import pandas as pd
# --- 1. ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏู ูุชู ---
categories = ['sci.space', 'rec.sport.baseball', 'comp.graphics']
data = fetch_20newsgroups(subset='train', categories=categories, shuffle=True, random_state=42)

# --- 2. ุชุจุฏู ูุชู ุจู ุจุฑุฏุงุฑ ูฺฺฏ ---
vectorizer = CountVectorizer(stop_words='english')
X = vectorizer.fit_transform(data.data)
y = data.target
print(vectorizer.get_feature_names_out())

# ููุท 10 ูฺฺฏ ุงูู ุจุฑุง ููุงุด
df_features = pd.DataFrame(X.toarray(), columns=vectorizer.get_feature_names_out())
print(df_features.head(10))

# --- 3. ุชูุณู ุฏุงุฏู ---
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# --- 4. ุณุงุฎุช ูุฏู ---
model = MultinomialNB()
model.fit(X_train, y_train)

# --- 5. ูพุดโุจู ---
y_pred = model.predict(X_test)

# --- 6. ุงุฑุฒุงุจ ---
print("Accuracy:", accuracy_score(y_test, y_pred))
print(classification_report(y_test, y_pred, target_names=categories))

# --- 7. ููุงุด ูุงุชุฑุณ ุฏุฑููโุฑุฎุชฺฏ ---
cm = confusion_matrix(y_test, y_pred)
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues', xticklabels=categories, yticklabels=categories)
plt.title("Confusion Matrix - MultinomialNB (Polynomial)")
plt.xlabel("Predicted")
plt.ylabel("Actual")
plt.show()

'''

ุชูุถุญ ุขููุฒุด:

 CountVectorizer ฺุณุชุ

ฺฉ ุงุจุฒุงุฑ ุงุฒ Scikit-learn ฺฉู ูุชูโูุง ุฑุง ุจู ุจุฑุฏุงุฑูุง ุนุฏุฏ (ูฺฺฏ) ุชุจุฏู ูโฺฉูุฏ.

  stop_words='english' ุนู ฺูุ

ุจู CountVectorizer ูโฺฏูู ฺฉููุงุช ูุนููู ู
 ุจโุงููุช ุฒุจุงู ุงูฺฏูุณ ุฑุง ุญุฐู ฺฉูุฏุ ูุซู:

the

is

and

of

to

at

from


ุงู ฺฉููุงุช ุงุทูุงุนุงุช ุฎุงุต ููโุฏููุฏุ ูพุณ ุญุฐู ูโุดููุฏ.

  ุฎุท ุฏูู
X = vectorizer.fit_transform(data.data)

ุงู ุฎุท ุฏู ฺฉุงุฑ ุงูุฌุงู ูโุฏูุฏ:

1- fit โ ุณุงุฎุชู ุฏฺฉุดูุฑ ฺฉููุงุช (Vocabulary)

CountVectorizer ฺฉู ุฏุชุงุณุช ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ:

ุชูุงู ฺฉููุงุช ููู ุฑุง ูพุฏุง ูโฺฉูุฏ

ฺฉ ูุณุช ุงุฒ ููู ฺฉููุงุช ูโุณุงุฒุฏ

ุจู ูุฑ ฺฉููู ฺฉ ุดูุงุฑู ุงุฎุชุตุงุต ูโุฏูุฏ (index)

ูุซูุงู:

index	word
0	space
1	mission
2	baseball
3	graphics


ุงู ููุงู features ูุงุณุช.

2- transform โ ุชุจุฏู ูุชูโูุง ุจู ุจุฑุฏุงุฑ ุนุฏุฏ

ุจุนุฏ ุงุฒ ุณุงุฎุชู ุฏฺฉุดูุฑ ฺฉููุงุชุ ุญุงูุง ุชูุงู ูุชูโูุง ุฑุง ุชุจุฏู ูโฺฉูุฏ ุจู ุงุนุฏุงุฏ:

ุชุนุฏุงุฏ ุชฺฉุฑุงุฑ ูุฑ ฺฉููู

ุจุฑุง ูุฑ ุณูุฏ ฺฉ ุฑุฏู (row) ุณุงุฎุชู ูโุดูุฏ

ุฎุฑูุฌ ฺฉ Sparse Matrix (ูุงุชุฑุณ ูุดุฑุฏู) ุงุณุช

ูุซูุงู:

ุงฺฏุฑ ุณูุฏ ุงูู 3 ุจุงุฑ ฺฉููู space ู 1 ุจุงุฑ graphics ุฏุงุดุชู ุจุงุดุฏ:

space	mission	baseball	graphics
3	0	0	1

ุงู ูโุดูุฏ ุฑุฏู ุงูู X

  ุฎุท ุณูู
y = data.target

 y ฺุณุชุ

ุจุฑฺุณุจ (Label) ูุฑ ูุชู.

ุฏุฑ ุงู ูุซุงู:

categories = ['sci.space', 'rec.sport.baseball', 'comp.graphics']


ุจูุงุจุฑุงู:

sci.space = 0

rec.sport.baseball = 1

comp.graphics = 2

ูพุณ ุงฺฏุฑ ูโุฎูุงูู ูุชู ุดูุงุฑู 10 ุฑุง ุจุฑุฑุณ ฺฉูู:

X[10] = ุจุฑุฏุงุฑ ูฺฺฏ ูุชู

y[10] = ุฏุณุชู (label) ุขู ูุชู

  ุฎูุงุตูู ุฎู ฺฉูุชุงู
CountVectorizer:

ูุชู โ ฺฉููุงุช โ ุจุฑุฏุงุฑ ุนุฏุฏ

X = ูฺฺฏโูุง (features)

ูุฑ ุณุทุฑ = ฺฉ ูุชู
ูุฑ ุณุชูู = ฺฉ ฺฉููู
ููุงุฏุฑ = ุชุนุฏุงุฏ ุชฺฉุฑุงุฑ ฺฉููู

y = ุงูุฏุงู (labels)

ฺฉูุงุณ ูุฑ ูุชู
(ูุถุงุ ุจุณุจุงูุ ฺฏุฑุงูฺฉ)   









 ุฏุฑ ุงู ูุฏูุ ุงุญุชูุงู ูุฑ ูฺฺฏ (ูุซู ฺฉููู) ุฏุฑ ูุฑ ฺฉูุงุณ ูุญุงุณุจู ูโุดูุฏ.
 ฺูู ุงุฒ ุดูุงุฑุด (CountVectorizer) ุงุณุชูุงุฏู ูโฺฉููุ ูฺฺฏโูุง ููุดู โฅ0 ูุณุชูุฏ.
 ฺฉุงุฑุจุฑุฏูุง: ุทุจููโุจูุฏ ูุชูุ ุชุญูู ุงุญุณุงุณุงุชุ ููุชุฑ ุงุณูพู.

fetch_20newsgroups ุฏุชุงุณุช ูุนุฑูู ุฎุจุฑ/ูุชู
 20 Newsgroups ุฑุง ุจุงุฑฺฏุฐุงุฑ ูโฺฉูุฏ.

categories โ ููุท ุณู ููุถูุน ุงูุชุฎุงุจ ุดุฏูโุงูุฏ:

sci.space โ ูุถุง/ุนูู

rec.sport.baseball โ ูุฑุฒุด ุจุณุจุงู

comp.graphics โ ฺฏุฑุงูฺฉ ฺฉุงููพูุชุฑ

subset='train' โ ุฏุงุฏูโูุง ุขููุฒุด ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.

shuffle=True โ ุฏุงุฏูโูุง ุฑุง ุจู ุตูุฑุช ุชุตุงุฏู ูุฑุชุจ ูโฺฉูุฏ.

random_state=42 โ ุจุฑุง ุชฺฉุฑุงุฑูพุฐุฑ ูุชุงุฌ.

ฒ. ุชุจุฏู ูุชู ุจู ุจุฑุฏุงุฑ ูฺฺฏ (Feature Extraction)
vectorizer = CountVectorizer(stop_words='english')
X = vectorizer.fit_transform(data.data)
y = data.target
CountVectorizer ูุชูโูุง ุฑุง ุจู ุจุฑุฏุงุฑ ุนุฏุฏ ุชุจุฏู ูโฺฉูุฏ (ุชุนุฏุงุฏ ฺฉููุงุช ูุฑ ูุชู).

stop_words='english' โ ุญุฐู ฺฉููุงุช ุนููู ูุซู the, is, and ุจุฑุง ฺฉุงูุด ููุฒ.

X โ ูุงุชุฑุณ ูฺฺฏโูุง (ูุฑ ุณุทุฑ = ฺฉ ูุชูุ ูุฑ ุณุชูู = ฺฉ ฺฉููู).

y โ ุจุฑฺุณุจ ูุฑ ูุชู (ฐุ ฑุ ฒ) ูุทุงุจู ุจุง ุชุฑุชุจ categories.

toarray() ฺุณุชุ

ููุช ูุชูโูุง ุฑุง ุจุง CountVectorizer ุชุจุฏู ูโฺฉููุ
 ุฎุฑูุฌ ฺฉ ูุงุชุฑุณ ุชูฺฉ ุง ูพุฑุงฺฉูุฏู (Sparse Matrix) ุงุณุช.

ุนู:

ุณุชููโูุง = ฺฉููุงุช

ุณุทุฑูุง = ูุชูโูุง

ุงูุง ฺูู ุชุนุฏุงุฏ ุฒุงุฏ ุตูุฑ ูุฌูุฏ ุฏุงุฑุฏุ ุจุฑุง ุตุฑููโุฌู
 ุฏุฑ ุญุงูุธูุ ูุงุชุฑุณ ุจูโุตูุฑุช ูุดุฑุฏู ุฐุฎุฑู ูโุดูุฏ.

ุจุฑุง ุงูฺฉู ุงู ูุงุชุฑุณ ุฑุง ูุซู ฺฉ ุขุฑุงู ุง DataFrame 
ูุนููู ุจุจููุ ุจุงุฏ ุขู ุฑุง ุชุจุฏู ฺฉูู ุจู:

 ฺฉ ุขุฑุงูโ ูุนููู NumPy

ุจุง ุฏุณุชูุฑ:

X.toarray()


ุงู ุนู: ยซุงู ูุงุชุฑุณ ุชูฺฉ ุฑุง ุจู ฺฉ ุขุฑุงูโ ฺฉุงูู ุชุจุฏู ฺฉูู.ยป

  ููููู ุณุทุฑูุง df_features ฺุณุชุ

ููุช ูโููุณู:

df_features = pd.DataFrame(X.toarray(),
            columns=vectorizer.get_feature_names_out())


ุงู ุฌุฏูู ุฏู ุจุนุฏ ุงุฌุงุฏ ูโุดูุฏ:

โ ูุฑ ุณุทุฑ = ฺฉ ูุชู (ุณูุฏ)

ุฏุฑ ุงู ูุซุงูุ ูุฑ ุณุทุฑ ฺฉ ุงูู/ูพุณุช/ุณูุฏ ุงุฒ ุฏุชุงุณุช 20Newsgroups ุงุณุช.

ูุซูุงู:

ุฎุท 0 = ุณูุฏ ุดูุงุฑู 0

ุฎุท 1 = ุณูุฏ ุดูุงุฑู 1

ุฎุท 2 = ุณูุฏ ุดูุงุฑู 2



ูุฑ ุณุทุฑ ูุดุงู ูโุฏูุฏ ฺฉู ุฏุฑ ุขู ูุชูุ ูุฑ ฺฉููู ฺูุฏ ุจุงุฑ ุชฺฉุฑุงุฑ ุดุฏู ุงุณุช.

โ ูุฑ ุณุชูู = ฺฉ ฺฉููู (Feature) ฺฉู CountVectorizer ุงุณุชุฎุฑุงุฌ ฺฉุฑุฏู

ูุซูุงู:

word	space	nasa	graphics	baseball	...
โ ูุฑ ุนุฏุฏ ุฏุงุฎู ุฌุฏูู = ุชุนุฏุงุฏ ุชฺฉุฑุงุฑ ุขู ฺฉููู ุฏุฑ ุขู ูุชู

ูุซุงู:

	space	baseball	graphics
0	 3	     0             1
1	 0	     5             0
2	 1	     0	           0

ูุนู:

ุณูุฏ ุดูุงุฑู 0ุ ฺฉูููโ space ุฑุง 3 ุจุงุฑ ุฏุงุฑุฏ

ุณูุฏ ุดูุงุฑู 1ุ ฺฉูููโ baseball ุฑุง 5 ุจุงุฑ ุฏุงุฑุฏ

ุณูุฏ ุดูุงุฑู 2ุ ฺฉูููโ graphics ุฑุง 0 ุจุงุฑ ุฏุงุฑุฏ

ุฌูุณู ต:                                             
ฺฉ ุงุฒ ูููโุชุฑู ู ุฌุฐุงุจโุชุฑู ุงูฺฏูุฑุชูโูุง ุฏุงุฏูโฺฉุงู:

  ุฌูุณู ต: ุงูฺฏูุฑุชู ูุงุดู ุจุฑุฏุงุฑ ูพุดุชุจุงู
  (SVM)
  
  

ฑ. ููุฏูู ู ุงุฏู ุงุตู                                     

ุงูฺฏูุฑุชู  SVM (Support Vector Machine    ฺฉ ุงุฒ ูุฏุฑุชููุฏุชุฑู ุฑูุดโูุง  ุฏุณุชูโุจูุฏ
 (Classification)  ู   ุฑฺฏุฑุณูู (Regression)  ุฏุฑ ุงุฏฺฏุฑ ูุงุดู ุงุณุช.

ุงุฏูโ ุงุตู ุขู:

  ูพุฏุง ฺฉุฑุฏู ยซุจูุชุฑู ุฎุทยป (ุง ุฏุฑ ูุถุง ฺูุฏุจุนุฏุ  ุตูุญูโ ุฌุฏุงฺฉููุฏู โ Hyperplane) ฺฉู 
ุฏุงุฏูโูุง ุฑุง ุจุง  ุจุดุชุฑู ูุงุตูู (Margin)  ุงุฒ ูู ุฌุฏุง ฺฉูุฏ.

 

  ฒ. ููุงูู ฺฉูุฏ

                                                                                              
 Hyperplane:       ููุงู ุฎุท ุง ุตูุญูโุง ุงุณุช ฺฉู ุฏุงุฏูโูุง ุฑุง ุงุฒ ูู ุฌุฏุง ูโฺฉูุฏ 
   ุฏุฑ ูุถุง ุฏูุจุนุฏุ ุฎุท ุงุณุชุ ุฏุฑ ุณูโุจุนุฏุ ุตูุญู.                         
                            
 Margin:             ูุงุตููโ ุจู Hyperplane ู ูุฒุฏฺฉโุชุฑู ุฏุงุฏูโูุง ุงุฒ ูุฑ ฺฉูุงุณ                                           |
 
 Support Vectors:     ุฏุงุฏูโูุง ฺฉู ุฑู ูุจูโ Margin ูุฑุงุฑ ุฏุงุฑูุฏ ู ููุด ุญุงุช ุฏุฑ ุชุนู ูุฑุฒ ุชุตูู ุฏุงุฑูุฏ.                   |
| **ูุฏู SVM**           ูพุฏุง ฺฉุฑุฏู ุตูุญูโุง ฺฉู Margin ุฑุง ุจุดูู ฺฉูุฏ. (ุนู ุฌุฏุงฺฉููุฏูโุง ุจุง ุจุดุชุฑู ุงุทููุงู)                      

 


 3. ุงููุงุน SVM

  Linear SVM:       ุฒูุงู ฺฉู ุฏุงุฏูโูุง ุจุง ฺฉ ุฎุท ุณุงุฏู ูุงุจู ุฌุฏุงุณุงุฒโุงูุฏ.                       
 Non-linear SVM: 
     ุฒูุงู ฺฉู ูุฑุฒ ูพฺุฏูโุชุฑ ูุงุฒู ุงุณุชุ ุงุฒ  Kernel Trick  ุงุณุชูุงุฏู ูโุดูุฏ.  

 

  4. Kernel Trick

ุงฺฏุฑ ุฏุงุฏูโูุง ุฏุฑ ูุถุง ุงุตู ุฌุฏุง ูุดููุฏุ
 ุขูโูุง ุฑุง ุจู ูุถุง ุจุงูุงุชุฑ ูโุจุฑู ุชุง ุจุชูุงูู ุจุง ุฎุท ุฌุฏุงุดุงู ฺฉูู.

  ูพุฑฺฉุงุฑุจุฑุฏุชุฑู ฺฉุฑููโูุง:

 linear: ูุฑุฒ ุฎุท
 poly:  ฺูุฏุฌูููโุง
 rbf:  ุชุงุจุน ุดุนุงุน (Radial Basis Function)

 

  5 . ูพุงุฏูโุณุงุฒ ุฏุฑ Python

'''

from sklearn import datasets
from sklearn.model_selection import train_test_split
from sklearn.svm import SVC
from sklearn.metrics import accuracy_score, confusion_matrix
import seaborn as sns
import matplotlib.pyplot as plt

# ุจุงุฑฺฏุฐุงุฑ ุฏุงุฏู
iris = datasets.load_iris()
X = iris.data
y = iris.target

# ุชูุณู ุฏุงุฏู
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# ูุฏู SVM ุจุง ฺฉุฑูู ุฎุท
model = SVC(kernel='linear')
model.fit(X_train, y_train)

# ูพุดโุจู
y_pred = model.predict(X_test)

# ุฏูุช ูุฏู
print("Accuracy:", accuracy_score(y_test, y_pred))

# ูุงุชุฑุณ ุฏุฑููโุฑุฎุชฺฏ
cm = confusion_matrix(y_test, y_pred)
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues')
plt.title("Confusion Matrix - SVM (Linear)")
plt.show()
 

 
'''
  6. ุขุฒูุงุด ฺฉุฑููโูุง ูุฎุชูู
 '''
 
 
for kernel in ['linear', 'poly', 'rbf', 'sigmoid']:
    model = SVC(kernel=kernel)
    model.fit(X_train, y_train)
    acc = accuracy_score(y_test, model.predict(X_test))
    print(f"Kernel = {kernel:8s}  โ  Accuracy = {acc:.3f}")

'''

  ุจุง ุชุบุฑ ฺฉุฑูู ูโุชูุงู ุฏุฏ ฺฉู ุจุนุถ ูุฑุฒูุง ุบุฑุฎุท ุนููฺฉุฑุฏ ุจูุชุฑ ุฏุงุฑูุฏ.

 

  7. ุชูุธู ูพุงุฑุงูุชุฑูุง

 C :  ฺฉูุชุฑู ุฌุฑูู ุจุฑุง ุฎุทุง ุฏุณุชูโุจูุฏ. 
   C ุจุฒุฑฺฏ : ูุฏู ุณุฎุชโฺฏุฑ 
 (ููฺฉู ุงุณุช overfit ุดูุฏ).
 
   C ฺฉูฺฺฉ : ูุฏู ุงูุนุทุงูโูพุฐุฑุชุฑ.    
 
 
 gamma (ฮณ):  ููุท ุฏุฑ ฺฉุฑููโูุง RBF ู Poly. ุชุนู ูโฺฉูุฏ ุดุนุงุน ุชุฃุซุฑ ูุฑ ุฏุงุฏู ฺูุฏุฑ ุจุงุดุฏ.
   ฮณ ุจุฒุฑฺฏ โ ูุฑุฒ ูพฺุฏูโุชุฑ (ููฺฉู ุงุณุช overfit). 

 

  8. ุงุฑุฒุงุจ ุจุง Cross Validation
''' 
from sklearn.model_selection import cross_val_score
import numpy as np

model = SVC(kernel='rbf', C=1, gamma=0.1)
scores = cross_val_score(model, X, y, cv=5)
print("ูุงูฺฏู ุฏูุช ต-ุชุง:", np.mean(scores))
 
'''
  9. ุฑุณู ูุฑุฒ ุชุตูู (ุจุฑุง ุฏู ูฺฺฏ ุงูู)

 '''
 
import numpy as np

X_2d = X[:, :2]  # ููุท ุฏู ูฺฺฏ ุงูู
'''

X_2d = X[:, 2:4]  : ููุท ูฺฺฏโูุง ุณูู ู ฺูุงุฑู
X_2d = X[:, [0, 2]]   :  ูฺฺฏ ฑ ู ณ
X_2d = X[:, [1, 3]]   :  ูฺฺฏ2 ู 4

ุงูุชุฎุงุจ ุฏุงุฏูโูุง ุฏูุจุนุฏ ุจุฑุง ุฑุณู
'''
model = SVC(kernel='linear')
'''  model = SVC(kernel='rbf', C=100, gamma=10)
'''
model.fit(X_2d, y)

# ูุญุฏูุฏู ุฑุณู
x_min, x_max = X_2d[:, 0].min() - 1, X_2d[:, 0].max() + 1
y_min, y_max = X_2d[:, 1].min() - 1, X_2d[:, 1].max() + 1
xx, yy = np.meshgrid(np.arange(x_min, x_max, 0.02),
                     np.arange(y_min, y_max, 0.02))

Z = model.predict(np.c_[xx.ravel(), yy.ravel()])
Z = Z.reshape(xx.shape)

plt.contourf(xx, yy, Z, alpha=0.3)
plt.scatter(X_2d[:, 0], X_2d[:, 1], c=y, edgecolors='k')
plt.title("Decision Boundary - Linear SVM")
plt.xlabel("Feature 1")
plt.ylabel("Feature 2")
plt.show()
'''
 meshgrid ุนู ุงุฌุงุฏ ฺฉ ุดุจฺฉู ูุณุชุทู ุงุฒ ููุงุท (ูุซู ุตูุญู ุดุทุฑูุฌ).

ูุฑ ุฎุงูู ุงุฒ ุงู ุดุจฺฉู ฺฉ ููุทู ุฏุฑ ุตูุญู ูฺฺฏโูุงุณุช.

ฺฏุงู 0.02 ุนู ูุถูุญ ุจุงูุง ุฏุฑูุชุฌู ูุฑุฒ ุชุตูู ุตุงูโุชุฑ ุฏุฏู ูโุดูุฏ.

ูุชุฌู:

xx ู yy ุฏู ุขุฑุงูโ 2ุจุนุฏ ูุณุชูุฏ ุจุง ูุฎุชุตุงุช ุชูุงู ููุงุท ุตูุญู.

xx.ravel() ู yy.ravel() โ ูุฑ ุฏู ุฑุง ุชุฎุช (1D) ูโฺฉูุฏ.

np.c_[ ... ] โ ุขูโูุง ุฑุง ุฏุฑ ฺฉูุงุฑ ูู ูโฺุณุจุงูุฏ ุชุง ุขุฑุงูโุง ุจุง ุดฺฉู (ุชุนุฏุงุฏ_ููุงุท, 2) ุจุณุงุฒุฏ.
(ฺูู ูุฏู ุงูุชุธุงุฑ ุฏุงุฑุฏ ูุฑูุฏ ุฏูุจุนุฏ ุจุงุดุฏ [x1, x2]).

model.predict(...) โ ูุฏู ุจุฑฺุณุจ ูุฑ ููุทู ุฑุง ูพุดโุจู ูโฺฉูุฏ.

reshape(xx.shape) โ ูุชุงุฌ ุฑุง ุจู ุดฺฉู ุดุจฺฉู ุงููู ุจุฑูโฺฏุฑุฏุงูุฏ 
ุชุง ุจุชูุงู ุขู ุฑุง ูุซู ููุดู ุฑูฺฏ ุฑุณู ฺฉุฑุฏ.




plt.contourf(xx, yy, Z, alpha=0.3)
โ ููุงุญ ุชุตูู ูุฏู ุฑุง ุจุง ุฑูฺฏโูุง ูุชูุงูุช ูพุฑ ูโฺฉูุฏ.
ูุฑ ุฑูฺฏ ูุดุงูโุฏููุฏูโ ฺฉ ฺฉูุงุณ ูุชูุงูุช ุงุณุช.
ููุฏุงุฑ alpha=0.3 ุนู ฺฉู ุดูุงู ุชุง ููุงุท ุงุตู ูู ุฏุฏู ุดููุฏ.

plt.scatter(...)
โ ููุงุท ูุงูุน ุฏุงุฏู (X_2d) ุฑุง ุฑุณู ูโฺฉูุฏ.

c=y โ ุฑูฺฏ ูุฑ ููุทู ุจุฑ ุงุณุงุณ ฺฉูุงุณ ูุงูุนโุงุด ุชูุธู ูโุดูุฏ.

edgecolors='k' โ ูุจูโ ุณุงู ุจุฑุง ูุถูุญ ุจุดุชุฑ.

plt.title, xlabel, ylabel โ ุชูุธู ุนููุงู ู ูุญูุฑูุง ูููุฏุงุฑ.
'''
'''

 ุฌูุนโุจูุฏ ููููู

 
  SVM:               ุฌุฏุง ฺฉุฑุฏู ุฏุงุฏูโูุง ุจุง ุญุฏุงฺฉุซุฑ Margin  
 Support Vectors :         ุฏุงุฏูโูุง ูุฑุฒ ุชุนูโฺฉููุฏู       
 Kernel:            ุชุจุฏู ูุถุง ุจุฑุง ุฏุงุฏูโูุง ุบุฑุฎุท    
 C ู gamma:        ุชูุธู ูพฺุฏฺฏ ู ุงูุนุทุงู ูุฏู        

 ููุฏุงุฑ ุจุฒุฑฺฏ C: ูุฏู ุชูุงุด ูโฺฉูุฏ ุชูุงู ุฏุงุฏูโูุง ุฑุง 
 ฺฉุงููุงู ุฌุฏุง ฺฉูุฏ โ ุงุญุชูุงู ุจุดโุจุฑุงุฒุด (Overfitting)
 

'''



